(()=>{var e={};e.id=4947,e.ids=[4947],e.modules={1303:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3599:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(37413),r=t(56254);function i({children:e}){return(0,a.jsx)(r.e,{children:e})}},8819:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13861:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},15616:(e,s,t)=>{"use strict";t.d(s,{T:()=>l});var a=t(60687),r=t(43210),i=t(96241);let l=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));l.displayName="Textarea"},16023:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21276:(e,s,t)=>{"use strict";t.d(s,{ProductReceiptPage:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call ProductReceiptPage() from the server but ProductReceiptPage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/inchwara/sawela/app/product-receipt/components/ProductReceiptPage.tsx","ProductReceiptPage")},22554:(e,s,t)=>{"use strict";t.r(s),t.d(s,{"00bc72096118e034d2cbdcc60f29bfedbc8b664370":()=>m,"4057d3663801ce2272a31510fb42437fc929c8a0cf":()=>u});var a=t(91199);t(42087);var r=t(7944),i=t(74208),l=t(96911);async function n(){try{let e=await (0,i.UL)();return e.get("token")?.value||null}catch(e){return null}}async function c(){try{let e=await (0,i.UL)(),s=e.get("user")?.value||null;if(s)return JSON.parse(s);return null}catch(e){return null}}async function d(){try{let e=(await (0,i.b3)()).get("authorization");if(e&&e.startsWith("Bearer "))return e.substring(7);return null}catch(e){return null}}async function o(e,s,t){let a=await n();if(a||(a=await d()),!a)throw Error("Authentication required, but no token found");let r={Accept:"application/json",Authorization:`Bearer ${a}`},i=t instanceof FormData;i||(r["Content-Type"]="application/json");let c={method:s,headers:r};t&&(i?c.body=t:c.body=JSON.stringify(t));let o=(0,l.e9)();try{let s=await fetch(`${o}${e}`,c);if(!(s.headers.get("content-type")||"").includes("application/json")){let e=await s.text();throw Error(`Server returned a non-JSON response. This may indicate a server error, a misconfigured endpoint, or a session timeout.

Response snippet: ${e.slice(0,200)}`)}let t=await s.json();if(!s.ok||t&&"failed"===t.status){let e="string"==typeof t.message?t.message:Object.values(t.message||{}).flat().join(", ")||"An unknown API error occurred.";throw Error(`API Error: ${e}`)}return t}catch(e){throw Error(`Network or API call failed: ${e.message}`)}}async function m(){try{let e=await n(),s=await d();return{success:!0,cookieToken:e?"Found":"Not found",headerToken:s?"Found":"Not found",message:"Token debug info"}}catch(e){return{success:!1,message:e.message||"Debug failed"}}}async function u(e){try{let s=await c();if(!s)throw Error("User data not found");let t=s.company?.id;if(!t)throw Error("Company ID not found in user data");let a=e.store_id||t,i=e.images,l=Array.isArray(i)?i.filter(Boolean):"string"==typeof i&&i.length>0?[i]:[],n=[];n=Array.isArray(e.tags)?e.tags.filter(Boolean):"string"==typeof e.tags?e.tags.split(",").map(e=>e.trim()).filter(Boolean):[];let d=Array.isArray(e.variants)?e.variants:Array.isArray(e.variations)?e.variations:[],m="number"==typeof e.primaryImageIndex&&!isNaN(e.primaryImageIndex)&&e.primaryImageIndex>=0&&e.primaryImageIndex<(l?.length||0)?e.primaryImageIndex:0,u={company_id:t,store_id:a,name:e.name.trim(),description:e.description||null,short_description:null,category:e.category||null,sku:e.sku?.trim()||null,barcode:e.barcode?.trim()||null,brand:e.brand?.trim()||null,supplier:e.supplier?.trim()||null,unit_of_measurement:e.unit_of_measurement||"pcs",is_active:e.isActive,track_inventory:e.trackInventory,weight:e.weight||null,length:e.dimensions.length?Number.parseFloat(e.dimensions.length):null,width:e.dimensions.width?Number.parseFloat(e.dimensions.width):null,height:e.dimensions.height?Number.parseFloat(e.dimensions.height):null,shipping_class:e.shippingClass||null,image_url:l.length>0&&l[m]?l[m]:null,images:l,primary_image_index:m,has_variations:e.hasVariations,tags:n,variations:Array.isArray(d)?d:[]},p=await o("/products","POST",u);return(0,r.revalidatePath)("/inventory"),{success:!0,data:p,message:"Product created successfully."}}catch(e){return{success:!1,message:e.message||"Failed to create product."}}}(0,t(33331).D)([m,u]),(0,a.A)(m,"00bc72096118e034d2cbdcc60f29bfedbc8b664370",null),(0,a.A)(u,"4057d3663801ce2272a31510fb42437fc929c8a0cf",null)},24011:(e,s,t)=>{Promise.resolve().then(t.bind(t,21276))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30788:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c,dynamic:()=>l,metadata:()=>i,revalidate:()=>n});var a=t(37413),r=t(21276);let i={title:"Product Receipts | Citimax",description:"Manage and view product receipts"},l="force-dynamic",n=4;function c(){return(0,a.jsx)(r.ProductReceiptPage,{})}},31158:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},33873:e=>{"use strict";e.exports=require("path")},36559:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>d});var a=t(65239),r=t(48088),i=t(88170),l=t.n(i),n=t(30893),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d={children:["",{children:["product-receipt",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,30788)),"/Users/inchwara/sawela/app/product-receipt/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,3599)),"/Users/inchwara/sawela/app/product-receipt/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,58014)),"/Users/inchwara/sawela/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["/Users/inchwara/sawela/app/product-receipt/page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/product-receipt/page",pathname:"/product-receipt",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},37588:(e,s,t)=>{"use strict";t.d(s,{ProductReceiptPage:()=>eq});var a=t(60687),r=t(43210),i=t(71702),l=t(85650),n=t(92241),c=t(59821),d=t(24934),o=t(78377),m=t(55192),u=t(29226);async function p(e){try{let s;if(e.document){let t=new FormData;e.supplier_id&&t.append("supplier_id",e.supplier_id),e.contractor_id&&t.append("contractor_id",e.contractor_id),t.append("document_type",e.document_type),t.append("reference_number",e.reference_number),t.append("store_id",e.store_id),e.container_number&&t.append("container_number",e.container_number),e.driver_name&&t.append("driver_name",e.driver_name),e.driver_id_number&&t.append("driver_id_number",e.driver_id_number),e.driver_phone&&t.append("driver_phone",e.driver_phone),e.vehicle_number_plate&&t.append("vehicle_number_plate",e.vehicle_number_plate),e.vehicle_description&&t.append("vehicle_description",e.vehicle_description),e.receipt_date&&t.append("receipt_date",e.receipt_date),e.landed_date&&t.append("landed_date",e.landed_date),t.append("items",JSON.stringify(e.items)),t.append("document",e.document),s=t}else s={supplier_id:e.supplier_id,contractor_id:e.contractor_id,document_type:e.document_type,reference_number:e.reference_number,store_id:e.store_id,items:e.items,...e.container_number&&{container_number:e.container_number},...e.driver_name&&{driver_name:e.driver_name},...e.driver_id_number&&{driver_id_number:e.driver_id_number},...e.driver_phone&&{driver_phone:e.driver_phone},...e.vehicle_number_plate&&{vehicle_number_plate:e.vehicle_number_plate},...e.vehicle_description&&{vehicle_description:e.vehicle_description},...e.receipt_date&&{receipt_date:e.receipt_date},...e.landed_date&&{landed_date:e.landed_date}};let t=await (0,u.Ay)("/whs/product-receipts","POST",s,!0);if("success"===t.status)return t;throw Error(t.message||"Failed to create product receipt")}catch(e){throw Error(`Failed to create product receipt: ${e.message||"Unknown error"}`)}}async function x(e){await (0,u.Ay)(`/whs/product-receipts/${e}`,"DELETE",void 0,!0)}async function h(){let e=await (0,u.Ay)("/whs/product-receipts","GET",void 0,!0);return e.receipts?.data||[]}async function g(e){console.log("getProductReceipt: fetching for id",e);let s=await (0,u.Ay)(`/whs/product-receipts/${e}`,"GET",void 0,!0);return console.log("getProductReceipt: API response",s),s}async function v(e,s){try{let t;if(s.document){let e=new FormData;s.supplier_id&&e.append("supplier_id",s.supplier_id),s.contractor_id&&e.append("contractor_id",s.contractor_id),e.append("document_type",s.document_type),e.append("reference_number",s.reference_number),e.append("store_id",s.store_id),s.container_number&&e.append("container_number",s.container_number),s.driver_name&&e.append("driver_name",s.driver_name),s.driver_id_number&&e.append("driver_id_number",s.driver_id_number),s.driver_phone&&e.append("driver_phone",s.driver_phone),s.vehicle_number_plate&&e.append("vehicle_number_plate",s.vehicle_number_plate),s.vehicle_description&&e.append("vehicle_description",s.vehicle_description),s.receipt_date&&e.append("receipt_date",s.receipt_date),s.landed_date&&e.append("landed_date",s.landed_date),e.append("items",JSON.stringify(s.items)),e.append("document",s.document),t=e}else t={supplier_id:s.supplier_id,contractor_id:s.contractor_id,document_type:s.document_type,reference_number:s.reference_number,store_id:s.store_id,items:s.items,container_number:s.container_number||null,driver_name:s.driver_name||null,driver_id_number:s.driver_id_number||null,driver_phone:s.driver_phone||null,vehicle_number_plate:s.vehicle_number_plate||null,vehicle_description:s.vehicle_description||null,receipt_date:s.receipt_date||null,landed_date:s.landed_date||null};let a=await (0,u.Ay)(`/whs/product-receipts/${e}`,"PUT",t,!0);if("success"===a.status)return a;throw Error(a.message||"Failed to update product receipt")}catch(e){throw Error(`Failed to update product receipt: ${e.message||"Unknown error"}`)}}async function j(){try{return await (0,u.Ay)("/whs/product-receipts/summary","GET",void 0,!0)}catch(e){throw console.error("Error fetching product receipt summary:",e),Error(`Failed to fetch product receipt summary: ${e.message||"Unknown error"}`)}}var y=t(19080),f=t(15574),b=t(10022),N=t(46001),_=t(58869),w=t(40228),C=t(88059),k=t(62688);let A=(0,k.A)("Container",[["path",{d:"M22 7.7c0-.6-.4-1.2-.8-1.5l-6.3-3.9a1.72 1.72 0 0 0-1.7 0l-10.3 6c-.5.2-.9.8-.9 1.4v6.6c0 .5.4 1.2.8 1.5l6.3 3.9a1.72 1.72 0 0 0 1.7 0l10.3-6c.5-.3.9-1 .9-1.5Z",key:"1t2lqe"}],["path",{d:"M10 21.9V14L2.1 9.1",key:"o7czzq"}],["path",{d:"m10 14 11.9-6.9",key:"zm5e20"}],["path",{d:"M14 19.8v-8.1",key:"159ecu"}],["path",{d:"M18 17.5V9.4",key:"11uown"}]]),S=(0,k.A)("IdCard",[["path",{d:"M16 10h2",key:"8sgtl7"}],["path",{d:"M16 14h2",key:"epxaof"}],["path",{d:"M6.17 15a3 3 0 0 1 5.66 0",key:"n6f512"}],["circle",{cx:"9",cy:"11",r:"2",key:"yxgjnd"}],["rect",{x:"2",y:"5",width:"20",height:"14",rx:"2",key:"qneu4z"}]]);var P=t(48340);let D=(0,k.A)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);var F=t(31158),E=t(13861),I=t(63143),R=t(96241),q=t(3018),$=t(41862),L=t(43649),V=t(9005);let T=(0,k.A)("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),J=(0,k.A)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),U=(0,k.A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function M({open:e,onOpenChange:s,documentUrl:t,documentName:i="Document",receiptNumber:l}){let[o,m]=(0,r.useState)(!0),[u,p]=(0,r.useState)(null),[x,h]=(0,r.useState)(null);if(!t)return null;let g=e=>{let s=e.split("?")[0];return s.split(".").pop()?.toLowerCase()||""},v=(e=>{let s=g(e);return"pdf"===s?"pdf":["jpg","jpeg","png","gif","webp","svg","bmp"].includes(s)?"image":["txt","csv","json","xml"].includes(s)?"text":"other"})(t),j=g(t),y=async e=>{try{console.log("Loading PDF document:",e);let s=await fetch(e,{method:"GET",headers:{Accept:"application/pdf,*/*"}});if(console.log("PDF fetch response status:",s.status),console.log("PDF fetch response headers:",Object.fromEntries(s.headers.entries())),!s.ok)throw Error(`HTTP error! status: ${s.status}`);let t=await s.blob();if(console.log("PDF blob type:",t.type,"size:",t.size),0===t.size)throw Error("Document is empty");if("application/pdf"===t.type||e.toLowerCase().includes(".pdf")){let e=URL.createObjectURL(t);console.log("Created blob URL:",e),h(e)}else p(`Invalid document type: ${t.type}`)}catch(e){console.error("PDF loading error:",e),p(`Failed to load PDF: ${e.message}`)}finally{m(!1)}},f=async()=>{try{let e=await fetch(t),s=await e.blob(),a=window.URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=i||`receipt-document.${j}`,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a)}catch(e){console.error("Download failed:",e),window.open(t,"_blank")}},N=()=>{window.open(t,"_blank")};return(0,a.jsx)(n.cj,{open:e,onOpenChange:s,children:(0,a.jsxs)(n.h,{className:"sm:max-w-4xl lg:max-w-6xl flex flex-col h-full",children:[(0,a.jsxs)(n.Fm,{className:"border-b border-gray-200 pb-4",children:[(0,a.jsxs)(n.qp,{className:"flex items-center gap-2",children:[(()=>{switch(v){case"pdf":return(0,a.jsx)(b.A,{className:"h-5 w-5 text-red-600"});case"image":return(0,a.jsx)(T,{className:"h-5 w-5 text-green-600"});case"text":return(0,a.jsx)(b.A,{className:"h-5 w-5 text-blue-600"});default:return(0,a.jsx)(J,{className:"h-5 w-5 text-gray-600"})}})(),"Document Viewer"]}),(0,a.jsx)(n.Qs,{children:l?(0,a.jsxs)(a.Fragment,{children:["Viewing document for receipt ",l]}):"Document preview"})]}),(0,a.jsx)("div",{className:"py-3 px-1 border-b border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 truncate",children:i}),(()=>{switch(v){case"pdf":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-red-100 text-red-800",children:"PDF"});case"image":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Image"});case"text":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"Text"});default:return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-gray-100 text-gray-800",children:j.toUpperCase()})}})(),t&&(0,a.jsx)("span",{className:"text-xs text-gray-500 font-mono truncate max-w-xs",children:t.split("/").pop()})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:N,className:"flex items-center gap-2",title:"Open in new tab",children:[(0,a.jsx)(U,{className:"h-4 w-4"}),"External"]}),(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:f,className:"flex items-center gap-2",title:"Download document",children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),"Download"]})]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden py-4",children:(()=>{if(o)return(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)($.A,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading document..."}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Please wait while we prepare your document"})]})]})});if(u)return(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"text-center space-y-4 max-w-md",children:[(0,a.jsx)(L.A,{className:"h-16 w-16 text-red-400 mx-auto"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Unable to preview this document"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:u}),(0,a.jsxs)(q.Fc,{children:[(0,a.jsx)(L.A,{className:"h-4 w-4"}),(0,a.jsxs)(q.TN,{children:["You can still download or open the document externally using the buttons below.",(0,a.jsx)("br",{}),(0,a.jsxs)("span",{className:"text-xs text-gray-400 mt-1 block",children:["Document URL: ",t]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{if(p(null),m(!0),"image"===v){let e=document.createElement("img");e.onload=()=>{h(t),m(!1)},e.onerror=()=>{p("Failed to load image after retry"),m(!1)},e.src=t+"?retry="+Date.now()}else"pdf"===v&&y(t)},className:"text-xs",children:"Try Again"})})]})]})]})]})});switch(v){case"pdf":return(0,a.jsx)("div",{className:"flex-1 border rounded-lg overflow-hidden bg-gray-50",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("iframe",{src:`${x}#toolbar=0&navpanes=0&scrollbar=1&view=FitH`,className:"w-full h-full min-h-[600px] bg-white",title:"PDF Viewer",style:{border:"none"}}),(0,a.jsx)("div",{className:"text-center p-4 border-t border-gray-200 bg-gray-50",children:(0,a.jsx)("p",{className:"text-xs text-gray-500",children:'If the PDF doesn\'t display properly, try the "External" or "Download" buttons above.'})})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(b.A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"PDF preview not available"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Use the external view or download buttons above"})]})})});case"image":return(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center p-4 bg-gray-50 rounded-lg",children:x?(0,a.jsx)("div",{className:"max-w-full max-h-full overflow-auto",children:(0,a.jsx)("img",{src:x,alt:"Document",className:"max-w-full h-auto rounded-lg shadow-lg border bg-white",style:{maxHeight:"80vh"}})}):(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(V.A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Image preview not available"})]})});case"text":return(0,a.jsx)("div",{className:"flex-1 border rounded-lg overflow-hidden bg-gray-50",children:x?(0,a.jsx)("div",{className:"w-full h-full p-4 bg-white overflow-auto",children:(0,a.jsx)("pre",{className:"text-sm font-mono whitespace-pre-wrap break-words max-w-full",children:x})}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(b.A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Text preview not available"})]})})});default:return(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(b.A,{className:"h-16 w-16 text-gray-400 mx-auto"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Preview not available"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["This file type (.",j,") cannot be previewed in the browser"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Use the download or external view options below"})]})]})})}})()}),(0,a.jsx)(n.XW,{className:"border-t border-gray-200 pt-4",children:(0,a.jsxs)("div",{className:"flex justify-between w-full",children:[(0,a.jsx)(d.$,{variant:"outline",onClick:()=>s(!1),children:"Close"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d.$,{variant:"outline",onClick:f,className:"flex items-center gap-2",children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),"Download"]}),(0,a.jsxs)(d.$,{onClick:N,className:"bg-[#E30040] hover:bg-[#E30040]/90 text-white flex items-center gap-2",children:[(0,a.jsx)(U,{className:"h-4 w-4"}),"Open External"]})]})]})})]})})}function O({open:e,onOpenChange:s,receiptId:t,onEdit:i}){let[l,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)(null),[h,v]=(0,r.useState)(null),[j,k]=(0,r.useState)(!1);r.useEffect(()=>{e&&t?(u(!0),v(null),g(t).then(e=>{x(e)}).catch(e=>{console.error("Error fetching receipt:",e),v("Failed to load receipt details")}).finally(()=>u(!1))):e||(x(null),v(null))},[e,t]);let q=p?.receipt,$=q?.product_receipt_items?.reduce((e,s)=>e+parseFloat(s.unit_price)*s.quantity,0)||0,L=async()=>{if(q?.document_url)try{let e=await fetch(q.document_url),s=await e.blob(),t=window.URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`receipt-${q.product_receipt_number||q.reference_number}-document`,document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(t)}catch(e){console.error("Download failed:",e),window.open(q.document_url,"_blank")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.cj,{open:e,onOpenChange:s,children:(0,a.jsxs)(n.h,{className:"sm:max-w-lg md:max-w-xl lg:max-w-4xl flex flex-col h-full",children:[(0,a.jsxs)(n.Fm,{className:"border-b border-gray-200 pb-4",children:[(0,a.jsxs)(n.qp,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-blue-600"}),"Product Receipt Details"]}),(0,a.jsx)(n.Qs,{children:q?.product_receipt_number?(0,a.jsxs)(a.Fragment,{children:["View details for receipt ",q.product_receipt_number]}):"Loading receipt details..."})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto py-6 space-y-6",children:l?(0,a.jsxs)("div",{className:"py-12 text-center text-muted-foreground",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-4"}),"Loading receipt details..."]}):h?(0,a.jsx)("div",{className:"py-12 text-center",children:(0,a.jsx)("div",{className:"text-red-500 mb-2",children:h})}):q?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-blue-600"}),"Receipt Overview"]})}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),"Receipt Number"]}),(0,a.jsx)("span",{className:"font-medium",children:q.product_receipt_number})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),"Reference Number"]}),(0,a.jsx)("span",{className:"font-medium",children:q.reference_number})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Document Type"}),(0,a.jsx)("div",{children:(e=>{switch(e?.toLowerCase()){case"purchase_order":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"Purchase Order"});case"invoice":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Invoice"});case"delivery_note":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:"Delivery Note"});case"manual":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-orange-100 text-orange-800",children:"Manual"});default:return(0,a.jsx)(c.E,{variant:"secondary",children:e})}})(q.document_type)})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(N.A,{className:"h-4 w-4"}),"Store"]}),(0,a.jsx)("span",{className:"font-medium",children:q.store?.name||"-"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(_.A,{className:"h-4 w-4"}),"Received By"]}),(0,a.jsx)("span",{className:"font-medium",children:[q.recipient?.first_name,q.recipient?.last_name].filter(Boolean).join(" ")||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(w.A,{className:"h-4 w-4"}),"Created At"]}),(0,a.jsx)("span",{className:"font-medium",children:q.created_at?new Date(q.created_at).toLocaleDateString():"-"})]})]})]})})]}),q.supplier&&(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-5 w-5 text-green-600"}),"Supplier Information"]})}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[q.supplier.name&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Name"}),(0,a.jsx)("span",{className:"font-medium",children:q.supplier.name})]}),q.supplier.email&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Email"}),(0,a.jsx)("span",{className:"font-medium",children:q.supplier.email})]}),q.supplier.phone&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Phone"}),(0,a.jsx)("span",{className:"font-medium",children:q.supplier.phone})]}),q.supplier.contact_person&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Contact Person"}),(0,a.jsx)("span",{className:"font-medium",children:q.supplier.contact_person})]})]})})]}),(q.container_number||q.driver_name||q.driver_id_number||q.driver_phone||q.vehicle_number_plate||q.vehicle_description||q.receipt_date||q.landed_date)&&(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 text-indigo-600"}),"Logistics & Delivery Details"]})}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(q.container_number||q.receipt_date||q.landed_date)&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(A,{className:"h-4 w-4"}),"Shipping Information"]}),q.container_number&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Container Number"}),(0,a.jsx)("span",{className:"font-medium font-mono",children:q.container_number})]}),q.landed_date&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(w.A,{className:"h-3.5 w-3.5"}),"Landed Date"]}),(0,a.jsx)("span",{className:"font-medium",children:new Date(q.landed_date).toLocaleDateString()})]}),q.receipt_date&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(w.A,{className:"h-3.5 w-3.5"}),"Receipt Date"]}),(0,a.jsx)("span",{className:"font-medium",children:new Date(q.receipt_date).toLocaleDateString()})]})]}),(q.driver_name||q.driver_id_number||q.driver_phone)&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4"}),"Driver Information"]}),q.driver_name&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Driver Name"}),(0,a.jsx)("span",{className:"font-medium",children:q.driver_name})]}),q.driver_id_number&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(S,{className:"h-3.5 w-3.5"}),"ID Number"]}),(0,a.jsx)("span",{className:"font-medium font-mono",children:q.driver_id_number})]}),q.driver_phone&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600 flex items-center gap-1",children:[(0,a.jsx)(P.A,{className:"h-3.5 w-3.5"}),"Phone"]}),(0,a.jsx)("span",{className:"font-medium",children:q.driver_phone})]})]}),(q.vehicle_number_plate||q.vehicle_description)&&(0,a.jsxs)("div",{className:"space-y-3 md:col-span-2",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(D,{className:"h-4 w-4"}),"Vehicle Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[q.vehicle_number_plate&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Number Plate"}),(0,a.jsx)("span",{className:"font-medium font-mono bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded",children:q.vehicle_number_plate})]}),q.vehicle_description&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Vehicle Description"}),(0,a.jsx)("span",{className:"font-medium",children:q.vehicle_description})]})]})]})]})})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-purple-600"}),"Product Items (",q.product_receipt_items?.length||0,")"]})}),(0,a.jsxs)(m.Wu,{children:[(0,a.jsx)("div",{className:"space-y-4",children:q.product_receipt_items?.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.product?.name||`Product ${e.product_id}`}),e.variant&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Variant: ",e.variant.name]}),e.product?.sku&&(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["SKU: ",e.product.sku]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-semibold text-lg text-gray-900",children:(0,R.vv)(parseFloat(e.unit_price)*e.quantity)}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.quantity," \xd7 ",(0,R.vv)(parseFloat(e.unit_price))]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Quantity:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:e.quantity})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Unit Price:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:(0,R.vv)(parseFloat(e.unit_price))})]}),e.expiry_date&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Expiry Date:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:new Date(e.expiry_date).toLocaleDateString()})]}),e.notes&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Notes:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:e.notes})]})]})]},s))}),(0,a.jsx)(o.w,{className:"my-4"}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-lg font-semibold",children:[(0,a.jsx)("span",{children:"Total Value:"}),(0,a.jsx)("span",{className:"text-green-600",children:(0,R.vv)($)})]})]})]}),q.document_url&&(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{className:"h-5 w-5 text-orange-600"}),"Attached Document"]})}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Document"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:L,className:"flex items-center gap-2",children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),"Download"]}),(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>k(!0),className:"flex items-center gap-2",children:[(0,a.jsx)(E.A,{className:"h-4 w-4"}),"View Document"]})]})]})})]})]}):(0,a.jsx)("div",{className:"py-12 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No receipt data available"})})}),q&&(0,a.jsx)(n.XW,{className:"border-t border-gray-200 pt-4",children:(0,a.jsxs)("div",{className:"flex justify-between w-full",children:[(0,a.jsx)(d.$,{variant:"outline",onClick:()=>s(!1),children:"Close"}),i&&(0,a.jsxs)(d.$,{onClick:()=>{t&&i&&(i(t),s(!1))},className:"bg-[#E30040] hover:bg-[#E30040]/90 text-white",children:[(0,a.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"Edit Receipt"]})]})})]})}),q&&(0,a.jsx)(M,{open:j,onOpenChange:k,documentUrl:q.document_url||null,documentName:`Receipt ${q.product_receipt_number||q.reference_number} Document`,receiptNumber:q.product_receipt_number})]})}var z=t(96752),B=t(68988),Z=t(63974),W=t(55629),H=t(99270),K=t(96474),Y=t(78122),G=t(47033),Q=t(14952),X=t(93661),ee=t(88233);function es({receipts:e,loading:s,onViewReceipt:t,onEditReceipt:i,onDeleteReceipt:n,search:o,onSearchChange:m,currentPage:u,totalPages:p,rowsPerPage:x,onPageChange:h,onRowsPerPageChange:g,totalItems:v,onRefresh:j,onCreateNew:y}){let[f,b]=(0,r.useState)(!1),[N,_]=(0,r.useState)(null),w=e=>{_(e),b(!0)},C=e=>{switch(e?.toLowerCase()){case"purchase_order":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"Purchase Order"});case"invoice":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Invoice"});case"delivery_note":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:"Delivery Note"});case"manual":return(0,a.jsx)(c.E,{variant:"secondary",className:"bg-orange-100 text-orange-800",children:"Manual"});default:return(0,a.jsx)(c.E,{variant:"secondary",children:e})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"flex space-x-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(H.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-500"}),(0,a.jsx)(B.p,{className:"pl-8 max-w-sm",placeholder:"Search receipts...",value:o,onChange:e=>m(e.target.value)})]})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(d.$,{size:"sm",onClick:y,className:"bg-primary text-white hover:bg-primary/90",children:[(0,a.jsx)(K.A,{className:"mr-2 h-4 w-4"}),"Create Receipt"]}),(0,a.jsxs)(d.$,{size:"sm",className:"bg-primary text-white hover:bg-primary/90",children:[(0,a.jsx)(F.A,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,a.jsxs)(d.$,{size:"sm",className:"bg-primary text-white hover:bg-primary/90",onClick:j,children:[(0,a.jsx)(Y.A,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]}),(0,a.jsx)("div",{className:"rounded-md border bg-white",children:(0,a.jsxs)(z.XI,{children:[(0,a.jsx)(z.A0,{children:(0,a.jsxs)(z.Hj,{children:[(0,a.jsx)(z.nd,{className:"font-semibold",children:"Receipt #"}),(0,a.jsx)(z.nd,{className:"font-semibold",children:"Store"}),(0,a.jsx)(z.nd,{className:"font-semibold",children:"Supplier"}),(0,a.jsx)(z.nd,{className:"font-semibold",children:"Items"}),(0,a.jsx)(z.nd,{className:"font-semibold",children:"Document Type"}),(0,a.jsx)(z.nd,{className:"font-semibold",children:"Received By"}),(0,a.jsx)(z.nd,{className:"font-semibold",children:"Created"}),(0,a.jsx)(z.nd,{className:"text-right font-semibold",children:"Actions"})]})}),(0,a.jsx)(z.BF,{children:s?(0,a.jsx)(z.Hj,{children:(0,a.jsx)(z.nA,{colSpan:8,className:"h-24 text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-[#E30040]"}),(0,a.jsx)("span",{children:"Loading product receipts..."})]})})}):0===e.length?(0,a.jsx)(z.Hj,{children:(0,a.jsx)(z.nA,{colSpan:8,className:"h-24 text-center",children:(0,a.jsxs)("div",{className:"text-gray-500",children:[(0,a.jsx)("p",{className:"font-semibold",children:"No product receipts found"}),(0,a.jsx)("p",{className:"text-sm",children:"Create your first receipt to get started"})]})})}):e.map(e=>(0,a.jsxs)(z.Hj,{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>w(e.id),children:[(0,a.jsx)(z.nA,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-[#E30040]",children:e.product_receipt_number||e.reference_number}),e.reference_number&&e.product_receipt_number!==e.reference_number&&(0,a.jsxs)("span",{className:"text-xs text-gray-500 mt-1",children:["Ref: ",e.reference_number]})]})}),(0,a.jsx)(z.nA,{children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.store?.name||"-"}),e.store?.code&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.store.code})]})}),(0,a.jsx)(z.nA,{children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.supplier?.name||"-"}),e.supplier?.email&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.supplier.email})]})}),(0,a.jsx)(z.nA,{children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:[e.items_count||0," item",1!==(e.items_count||0)?"s":""]}),e.product_receipt_items&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Total Qty: ",e.product_receipt_items.reduce((e,s)=>e+(s.quantity||0),0)]})]})}),(0,a.jsx)(z.nA,{children:C(e.document_type)}),(0,a.jsx)(z.nA,{children:e.recipient?(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:[e.recipient.first_name,e.recipient.last_name].filter(Boolean).join(" ")||"-"}),e.recipient.email&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.recipient.email})]}):(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Not specified"})}),(0,a.jsx)(z.nA,{children:(0,a.jsxs)("div",{className:"text-sm",children:[e.created_at?(0,l.GP)(new Date(e.created_at),"MMM dd, yyyy"):"-",e.created_at&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,l.GP)(new Date(e.created_at),"HH:mm")})]})}),(0,a.jsx)(z.nA,{className:"text-right",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(et,{receipt:e,onView:()=>w(e.id),onEdit:()=>i(e),onDelete:()=>n(e)})})]},e.id))})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Rows per page"}),(0,a.jsxs)(Z.l6,{value:x.toString(),onValueChange:e=>{g(Number(e)),h(1)},children:[(0,a.jsx)(Z.bq,{className:"h-8 w-[70px]",children:(0,a.jsx)(Z.yv,{placeholder:x})}),(0,a.jsx)(Z.gC,{side:"top",children:[5,10,20,30,40,50].map(e=>(0,a.jsx)(Z.eb,{value:e.toString(),children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(d.$,{size:"sm",onClick:()=>h(Math.max(u-1,1)),disabled:1===u,className:"bg-primary text-white hover:bg-primary/90 disabled:opacity-50",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),"Previous"]}),(0,a.jsxs)("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",u," of ",p||1]}),(0,a.jsxs)(d.$,{size:"sm",onClick:()=>h(Math.min(u+1,p||1)),disabled:u===p||0===p,className:"bg-primary text-white hover:bg-primary/90 disabled:opacity-50",children:["Next",(0,a.jsx)(Q.A,{className:"h-4 w-4"})]})]})]})]}),(0,a.jsx)(O,{open:f,onOpenChange:e=>{b(e),e||_(null)},receiptId:N,onEdit:s=>{let t=e.find(e=>e.id===s);t&&i(t)}})]})}function et({receipt:e,onView:s,onEdit:t,onDelete:r}){return(0,a.jsxs)(W.rI,{children:[(0,a.jsx)(W.ty,{asChild:!0,children:(0,a.jsx)(d.$,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,a.jsx)(X.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(W.SQ,{align:"end",children:[(0,a.jsx)(W.lp,{children:"Actions"}),(0,a.jsxs)(W._2,{onClick:s,children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-2"})," View Details"]}),(0,a.jsxs)(W._2,{onClick:t,children:[(0,a.jsx)(I.A,{className:"h-4 w-4 mr-2"})," Edit Receipt"]}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.mB,{}),(0,a.jsxs)(W._2,{onClick:r,className:"text-red-600 focus:text-red-600",children:[(0,a.jsx)(ee.A,{className:"h-4 w-4 mr-2"})," Delete Receipt"]})]})]})]})}var ea=t(28561),er=t(79300),ei=t(74797);function el(){let{data:e,isLoading:s,error:t}=(0,ei.e1)("product_receipt_summary",()=>j(),{expirationMs:3e5,autoRefresh:!1}),r={totalReceipts:e?.data?.overview?.total_receipts||0,totalQuantity:e?.data?.overview?.total_items_received||0,uniqueProducts:e?.data?.overview?.total_line_items||0,totalValue:e?.data?.financial?.total_receipt_value||0};return t&&console.error("Error loading product receipt summary:",t),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(m.ZB,{className:"text-sm font-medium",children:"Total Receipts"}),(0,a.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(m.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s?(0,a.jsx)("div",{className:"h-6 w-16 bg-gray-200 rounded animate-pulse"}):r.totalReceipts}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time receipts"})]})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(m.ZB,{className:"text-sm font-medium",children:"Total Quantity"}),(0,a.jsx)(ea.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(m.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s?(0,a.jsx)("div",{className:"h-6 w-16 bg-gray-200 rounded animate-pulse"}):r.totalQuantity.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Items received"})]})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(m.ZB,{className:"text-sm font-medium",children:"Line Items"}),(0,a.jsx)(er.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(m.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s?(0,a.jsx)("div",{className:"h-6 w-16 bg-gray-200 rounded animate-pulse"}):r.uniqueProducts}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total line items"})]})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(m.ZB,{className:"text-sm font-medium",children:"Total Value"}),(0,a.jsx)(N.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(m.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s?(0,a.jsx)("div",{className:"h-6 w-24 bg-gray-200 rounded animate-pulse"}):`KES ${r.totalValue.toLocaleString()}`}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Receipt value"})]})]})]})}var en=t(39390),ec=t(56338);t(56792),t(14921);var ed=t(22064),eo=t(15616),em=t(42902),eu=t(85910),ep=t(11860),ex=t(1303),eh=t(16023),eg=t(64398),ev=t(30474),ej=t(6475);let ey=(0,ej.createServerReference)("4057d3663801ce2272a31510fb42437fc929c8a0cf",ej.callServer,void 0,ej.findSourceMapURL,"createProduct");function ef({isOpen:e,onClose:s,onSuccess:t}){let{toast:l}=(0,i.dj)(),[n,o]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)("basic"),[h,g]=(0,r.useState)({}),v=["basic","pricing","inventory","variations","media"],[j,y]=(0,r.useState)(""),[f,b]=(0,r.useState)(""),[N,_]=(0,r.useState)(""),[w,C]=(0,r.useState)(""),[k,A]=(0,r.useState)(""),[S,P]=(0,r.useState)([]),[D,F]=(0,r.useState)(""),[E,I]=(0,r.useState)(""),[T,J]=(0,r.useState)(""),[U,M]=(0,r.useState)(""),[O,z]=(0,r.useState)(""),[W,H]=(0,r.useState)(""),[Y,G]=(0,r.useState)(!0),[Q,X]=(0,r.useState)(!0),[es,et]=(0,r.useState)(""),[ea,er]=(0,r.useState)({length:"",width:"",height:""}),[ei,el]=(0,r.useState)(""),[ej,ef]=(0,r.useState)([]),[eb,eN]=(0,r.useState)(0),[e_,ew]=(0,r.useState)(!1),[eC,ek]=(0,r.useState)(!1),[eA,eS]=(0,r.useState)([]),[eP,eD]=(0,r.useState)(""),[eF,eE]=(0,r.useState)("pcs"),[eI,eR]=(0,r.useState)(""),[eq,e$]=(0,r.useState)([]),[eL,eV]=(0,r.useState)(""),[eT,eJ]=(0,r.useState)(!1),[eU,eM]=(0,r.useState)([]),[eO,ez]=(0,r.useState)(!1),[eB,eZ]=(0,r.useState)(!1),[eW,eH]=(0,r.useState)(""),[eK,eY]=(0,r.useState)(""),[eG,eQ]=(0,r.useState)("#6B7280"),[eX,e0]=(0,r.useState)(!0),[e1,e2]=(0,r.useState)(!1),[e4,e6]=(0,r.useState)([]),[e5,e3]=(0,r.useState)(!1),[e8,e7]=(0,r.useState)(""),[e9,se]=(0,r.useState)(!1),[ss,st]=(0,r.useState)([]),[sa,sr]=(0,r.useState)(!1),si=(0,r.useRef)(null),sl=(e,s)=>{let t=e.toLowerCase().trim(),a=s.toLowerCase().trim();if(t===a)return 1;if(0===t.length||0===a.length)return 0;if(t.includes(a)||a.includes(t))return .8;let r=[];for(let e=0;e<=t.length;e++)r[e]=[e];for(let e=0;e<=a.length;e++)r[0][e]=e;for(let e=1;e<=t.length;e++)for(let s=1;s<=a.length;s++){let i=+(t[e-1]!==a[s-1]);r[e][s]=Math.min(r[e-1][s]+1,r[e][s-1]+1,r[e-1][s-1]+i)}let i=Math.max(t.length,a.length);return 1-r[t.length][a.length]/i},sn=(0,r.useCallback)(async e=>{if(!e||e.trim().length<2)return void st([]);sr(!0);try{let s=await (0,ec.d$)(1,50,{search:e.trim()});if(s.data&&s.data.length>0){let t=s.data.filter(s=>sl(e,s.name)>.5).slice(0,5);st(t)}else st([])}catch(e){console.error("Error checking similar products:",e),st([])}finally{sr(!1)}},[]),sc=e=>{y(e),h.name&&g(e=>({...e,name:void 0})),si.current&&clearTimeout(si.current),si.current=setTimeout(()=>{sn(e)},500)},sd=e=>{let s={};return"basic"!==e||j.trim()||(s.name="Product name is required"),"pricing"===e&&(!E||0>=Number.parseFloat(E))&&(s.price="Valid selling price is required"),"inventory"!==e||eL||(s.store="Store selection is required"),g(s),0===Object.keys(s).length},so=()=>{D.trim()&&!S.includes(D.trim())&&(P([...S,D.trim()]),F(""))},sm=e=>{P(S.filter(s=>s!==e))},su=(e,s=800,t=800,a=200)=>new Promise((r,i)=>{let l=document.createElement("canvas"),n=l.getContext("2d"),c=document.createElement("img");if(!n)return void i(Error("Failed to get canvas context"));c.onload=()=>{try{let{width:e,height:i}=c,d=e/i;e>i?e>s&&(i=(e=s)/d):i>t&&(e=(i=t)*d),e>s&&(i=(e=s)/d),i>t&&(e=(i=t)*d),l.width=e,l.height=i,n.drawImage(c,0,0,e,i);let o=e=>{let s=e.split(",")[1]?.length||0;return .75*s/1024},m=.9,u=l.toDataURL("image/jpeg",m),p=o(u);for(;p>a&&m>.1;)m-=.1,u=l.toDataURL("image/jpeg",m),p=o(u);if(p>a){let s=Math.sqrt(a/p);l.width=Math.floor(e*s),l.height=Math.floor(i*s),n.drawImage(c,0,0,l.width,l.height),u=l.toDataURL("image/jpeg",.8)}r(u)}catch(e){i(e)}},c.onerror=()=>{i(Error("Failed to load image"))},c.src=URL.createObjectURL(e)}),sp=async e=>{let s=e.target.files;if(s){for(let e of Array.from(s))if(e.type.startsWith("image/"))try{let s=Math.round(e.size/1024),t=await su(e),a=t.split(",")[1]?.length||0,r=Math.round(.75*a/1024);ef(e=>{let s=[...e,t];return 0===e.length&&eN(0),s}),l({title:"Image Uploaded",description:`Image compressed from ${s}KB to ${r}KB`})}catch(e){l({title:"Upload Error",description:"Failed to process image",variant:"destructive"})}else l({title:"Invalid File",description:"Please upload only image files",variant:"destructive"});e.target.value=""}},sx=async e=>{e.preventDefault(),e.stopPropagation(),ew(!1);let s=e.dataTransfer.files;if(s)for(let e of Array.from(s))if(e.type.startsWith("image/"))try{let s=Math.round(e.size/1024),t=await su(e),a=t.split(",")[1]?.length||0,r=Math.round(.75*a/1024);ef(e=>{let s=[...e,t];return 0===e.length&&eN(0),s}),l({title:"Image Uploaded",description:`Image compressed from ${s}KB to ${r}KB`})}catch(e){l({title:"Upload Error",description:"Failed to process image",variant:"destructive"})}else l({title:"Invalid File",description:"Please upload only image files",variant:"destructive"})},sh=e=>{ef(s=>{let t=s.filter((s,t)=>t!==e);return e===eb?eN(0):e<eb&&eN(eb-1),t})},sg=e=>{eN(e),l({title:"Primary Image Set",description:`Image ${e+1} is now the primary image`})},sv=(e,s,t)=>{eS(a=>a.map(a=>a.id===e?{...a,[s]:t}:a))},sj=e=>{eS(s=>s.filter(s=>s.id!==e))},sy=e=>{eS(s=>s.map(s=>s.id===e?{...s,attributes:[...s.attributes,{key:"",value:""}]}:s))},sf=(e,s,t,a)=>{eS(r=>r.map(r=>r.id===e?{...r,attributes:r.attributes.map((e,r)=>r===s?{...e,[t]:a}:e)}:r))},sb=(e,s)=>{eS(t=>t.map(t=>t.id===e?{...t,attributes:t.attributes.filter((e,t)=>t!==s)}:t))},sN=e=>{eS(s=>s.map(s=>s.id===e?{...s,options:[...s.options,""]}:s))},s_=(e,s,t)=>{eS(a=>a.map(a=>{if(a.id===e){let e=a.options[s],r=a.options.map((e,a)=>a===s?t:e),i=[...a.option_stocks];if(e&&e!==t){let s=i.findIndex(s=>s.option===e);s>=0&&(i[s]={...i[s],option:t})}return{...a,options:r,option_stocks:i}}return a}))},sw=(e,s)=>{eS(t=>t.map(t=>{if(t.id===e){let e=t.options[s],a=t.options.filter((e,t)=>t!==s),r=t.option_stocks.filter(s=>s.option!==e);return{...t,options:a,option_stocks:r}}return t}))},sC=(e,s,t)=>{eS(a=>a.map(a=>{if(a.id===e){let e=a.option_stocks.findIndex(e=>e.option===s);if(!(e>=0))return{...a,option_stocks:[...a.option_stocks,{option:s,stock:t}]};{let r=[...a.option_stocks];return r[e]={option:s,stock:t},{...a,option_stocks:r}}}return a}))},sk=async(e,s)=>{let t=s.target.files;if(t){for(let s of Array.from(t))if(s.type.startsWith("image/"))try{let t=Math.round(s.size/1024),a=await su(s),r=a.split(",")[1]?.length||0,i=Math.round(.75*r/1024);eS(s=>s.map(s=>s.id===e?{...s,images:[...s.images,a]}:s)),l({title:"Variant Image Uploaded",description:`Image compressed from ${t}KB to ${i}KB`})}catch(e){l({title:"Upload Error",description:"Failed to process variant image",variant:"destructive"})}else l({title:"Invalid File",description:"Please upload only image files",variant:"destructive"});s.target.value=""}},sA=(e,s)=>{eS(t=>t.map(t=>t.id===e?{...t,images:t.images.filter((e,t)=>t!==s)}:t))},sS=async()=>{if(!["basic","pricing","inventory","variations"].every(e=>sd(e)))return void l({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});o(!0);try{if(!eL){l({title:"Validation Error",description:"Please select a store for this product",variant:"destructive"}),o(!1);return}let e={name:j.trim(),description:f,category_id:N||void 0,brand:w,supplier:k,tags:S,price:Number.parseFloat(E)||0,cost:Number.parseFloat(T)||0,sku:U,barcode:eI.trim()||void 0,stock:Number.parseInt(O)||0,lowStockThreshold:Number.parseInt(W)||0,trackInventory:!!Y,isActive:!!Q,is_active:!!Q,weight:Number.parseFloat(es)||0,dimensions:ea,shippingClass:ei,last_price:eP?Number.parseFloat(eP):void 0,unit_of_measurement:eF,images:ej,image_url:ej.length>0?ej[eb]:null,primaryImageIndex:eb,hasVariations:eC,store_id:eL,variants:eC&&eA.length>0?eA.map(e=>({name:e.name.trim(),sku:e.sku.trim(),price:Number.parseFloat(e.price)||0,cost:Number.parseFloat(e.cost)||0,stock_quantity:Number.parseInt(e.stock_quantity)||0,is_active:e.is_active,store_id:e.store_id||eL,options:e.options.filter(e=>""!==e.trim()),images:e.images,attributes:e.attributes&&e.attributes.length>0?e.attributes.reduce((e,s)=>(s.key.trim()&&s.value.trim()&&(e[s.key.trim()]=s.value.includes(",")?s.value.split(",").map(e=>e.trim()):s.value.trim()),e),{}):{}})):[]},a=await ey(e);a.success?(l({title:"Success",description:a.message||"Product created successfully."}),sP(),s(),setTimeout(()=>{t?.()},100)):l({title:"Error",description:a.message||"Failed to create product.",variant:"destructive"})}catch(e){l({title:"Error",description:e instanceof Error?e.message:"Failed to create product. Please try again.",variant:"destructive"})}finally{o(!1)}},sP=()=>{y(""),b(""),_(""),C(""),A(""),P([]),I(""),J(""),M(""),eR(""),z(""),H(""),G(!0),X(!0),et(""),er({length:"",width:"",height:""}),el(""),ef([]),eN(0),ek(!1),eS([]),eD(""),eE("pcs"),eR(""),eV(""),x("basic"),g({}),e7(""),se(!1),st([])},sD=v.indexOf(p),sF=sD===v.length-1,sE=async()=>{if(eW.trim()){e2(!0);try{let e=await (0,ed.Ez)({name:eW.trim(),description:eK.trim()||void 0,color:eG,is_active:eX});e.success&&e.category?(eM(s=>[e.category,...s]),_(e.category.id),l({title:"Category Created",description:e.message||"New category added."}),eZ(!1),eH(""),eY(""),eQ("#6B7280"),e0(!0)):l({title:"Error",description:e.message||"Failed to create category",variant:"destructive"})}catch(e){l({title:"Error",description:e instanceof Error?e.message:"Failed to create category",variant:"destructive"})}finally{e2(!1)}}};return m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,R.cn)("fixed inset-0 bg-black/50 z-50 transition-opacity duration-300",e?"opacity-100":"opacity-0"),onClick:s}),(0,a.jsxs)("div",{className:(0,R.cn)("fixed top-0 right-0 h-full w-full sm:max-w-4xl bg-white shadow-xl z-50 transition-transform duration-300 ease-in-out",e?"translate-x-0":"translate-x-full"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b",children:[(0,a.jsx)("h2",{className:"text-lg sm:text-xl font-semibold",children:"Create New Product"}),(0,a.jsx)(d.$,{variant:"ghost",size:"sm",onClick:s,children:(0,a.jsx)(ep.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 h-[calc(100vh-140px)]",children:(0,a.jsxs)(eu.tU,{value:p,onValueChange:e=>{let s=v.indexOf(e),t=v.indexOf(p);s<=t||s===t+1&&sd(p)?(x(e),g({})):s>t+1?l({title:"Complete Previous Steps",description:"Please complete the current step before proceeding to later steps",variant:"destructive"}):l({title:"Validation Error",description:"Please fill in all required fields before proceeding",variant:"destructive"})},className:"space-y-4",children:[(0,a.jsxs)(eu.j7,{className:"grid w-full grid-cols-3 sm:grid-cols-5 h-auto gap-1 p-1",children:[(0,a.jsx)(eu.Xi,{value:"basic",className:(0,R.cn)("text-xs px-1 sm:px-2 py-2",sD>=0?"opacity-100":"opacity-50"),children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[sD>0&&(0,a.jsx)("span",{className:"text-green-600",children:""}),"Basic"]})}),(0,a.jsx)(eu.Xi,{value:"pricing",className:(0,R.cn)("text-xs px-1 sm:px-2 py-2",sD>=1?"opacity-100":"opacity-50"),disabled:sD<1,children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[sD>1&&(0,a.jsx)("span",{className:"text-green-600",children:""}),"Price"]})}),(0,a.jsx)(eu.Xi,{value:"inventory",className:(0,R.cn)("text-xs px-1 sm:px-2 py-2",sD>=2?"opacity-100":"opacity-50"),disabled:sD<2,children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[sD>2&&(0,a.jsx)("span",{className:"text-green-600",children:""}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Stock"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Inv"})]})}),(0,a.jsx)(eu.Xi,{value:"variations",className:(0,R.cn)("text-xs px-1 sm:px-2 py-2 col-span-3 sm:col-span-1",sD>=3?"opacity-100":"opacity-50"),disabled:sD<3,children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[sD>3&&(0,a.jsx)("span",{className:"text-green-600",children:""}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Variants"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Vars"})]})}),(0,a.jsx)(eu.Xi,{value:"media",className:(0,R.cn)("text-xs px-1 sm:px-2 py-2 col-span-3 sm:col-span-1",sD>=4?"opacity-100":"opacity-50"),disabled:sD<4,children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[sD>4&&(0,a.jsx)("span",{className:"text-green-600",children:""}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Images"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Imgs"})]})})]}),(0,a.jsxs)(eu.av,{value:"basic",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"name",children:"Product Name *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(B.p,{id:"name",value:j,onChange:e=>sc(e.target.value),placeholder:"Enter product name",className:h.name?"border-red-500":""}),sa&&(0,a.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,a.jsx)($.A,{className:"h-4 w-4 animate-spin text-muted-foreground"})})]}),h.name&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:h.name}),ss.length>0&&(0,a.jsxs)(q.Fc,{variant:"default",className:"mt-2 border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:[(0,a.jsx)(L.A,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),(0,a.jsx)(q.XL,{className:"text-amber-800 dark:text-amber-200 text-sm",children:"Similar products found"}),(0,a.jsxs)(q.TN,{className:"text-amber-700 dark:text-amber-300 text-xs",children:[(0,a.jsx)("p",{className:"mb-1",children:"The following products have similar names:"}),(0,a.jsx)("ul",{className:"list-disc pl-4 space-y-0.5",children:ss.map(e=>(0,a.jsxs)("li",{className:"truncate",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),e.sku&&(0,a.jsxs)("span",{className:"text-amber-600 dark:text-amber-400 ml-1",children:["(",e.sku,")"]})]},e.id))}),(0,a.jsx)("p",{className:"mt-1 text-amber-600 dark:text-amber-400",children:"Please verify this is a new product before continuing."})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"category",children:"Category (optional)"}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)(Z.l6,{value:N,onValueChange:e=>{_(e)},children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{placeholder:eO?"Loading categories...":"Select category (optional)"})}),(0,a.jsxs)(Z.gC,{children:[0===eU.length&&!eO&&(0,a.jsx)("div",{className:"px-2 py-1 text-sm text-muted-foreground",children:"No categories found"}),eU.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"h-3 w-3 rounded-full border",style:{backgroundColor:e.color||"#6B7280"}}),e.name]})},e.id)),(0,a.jsx)("div",{className:"border-t my-1"}),(0,a.jsxs)(d.$,{type:"button",variant:"ghost",className:"w-full justify-start text-left text-sm",onClick:()=>eZ(!0),children:[(0,a.jsx)(ex.A,{className:"h-4 w-4 mr-2"})," Create Category"]})]})]})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(eo.T,{id:"description",value:f,onChange:e=>b(e.target.value),placeholder:"Enter product description (optional)",rows:5})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"brand",children:"Brand"}),(0,a.jsx)(B.p,{id:"brand",value:w,onChange:e=>C(e.target.value),placeholder:"Product brand (optional)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"Tags"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:S.map(e=>(0,a.jsxs)(c.E,{variant:"secondary",className:"flex items-center gap-1",children:[e,(0,a.jsx)(ep.A,{className:"h-3 w-3 cursor-pointer",onClick:()=>sm(e)})]},e))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(B.p,{value:D,onChange:e=>F(e.target.value),placeholder:"Add tag (optional)",onKeyPress:e=>"Enter"===e.key&&so()}),(0,a.jsx)(d.$,{type:"button",onClick:so,variant:"outline",children:"Add"})]})]})]}),(0,a.jsxs)(eu.av,{value:"pricing",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"price",children:"Selling Price *"}),(0,a.jsx)(B.p,{id:"price",type:"number",step:"0.01",value:E,onChange:e=>{I(e.target.value),h.price&&g(e=>({...e,price:void 0}))},placeholder:"0.00",className:h.price?"border-red-500":""}),h.price&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:h.price})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"cost",children:"Cost Price"}),(0,a.jsx)(B.p,{id:"cost",type:"number",step:"0.01",value:T,onChange:e=>J(e.target.value),placeholder:"0.00 (optional)"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"lastPrice",children:"Last Price"}),(0,a.jsx)(B.p,{id:"lastPrice",type:"number",step:"0.01",value:eP,onChange:e=>eD(e.target.value),placeholder:"0.00 (optional)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"unitOfMeasurement",children:"Unit of Measurement"}),(0,a.jsxs)(Z.l6,{value:eF,onValueChange:eE,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{placeholder:"Select unit of measurement (optional)"})}),(0,a.jsx)(Z.gC,{children:["pcs","kg","g","lb","oz","liter","ml","m","cm","ft","inch","box","pack","pair","set","dozen","roll","bottle","can","bag","carton"].map(e=>(0,a.jsx)(Z.eb,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"sku",children:"SKU"}),(0,a.jsx)(B.p,{id:"sku",value:U,onChange:e=>{M(e.target.value)},placeholder:"Product SKU (optional)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"barcode",children:"Barcode"}),(0,a.jsx)(B.p,{id:"barcode",value:eI,onChange:e=>eR(e.target.value),placeholder:"Product barcode (optional)"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"weight",children:"Weight (kg)"}),(0,a.jsx)(B.p,{id:"weight",type:"number",step:"0.01",value:es,onChange:e=>et(e.target.value),placeholder:"0.00 (optional)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"Dimensions (cm)"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsx)(B.p,{type:"number",value:ea.length,onChange:e=>er(s=>({...s,length:e.target.value})),placeholder:"Length (optional)"}),(0,a.jsx)(B.p,{type:"number",value:ea.width,onChange:e=>er(s=>({...s,width:e.target.value})),placeholder:"Width (optional)"}),(0,a.jsx)(B.p,{type:"number",value:ea.height,onChange:e=>er(s=>({...s,height:e.target.value})),placeholder:"Height (optional)"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"shippingClass",children:"Shipping Class"}),(0,a.jsxs)(Z.l6,{value:ei,onValueChange:el,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{placeholder:"Select shipping class (optional)"})}),(0,a.jsx)(Z.gC,{children:["standard","express","overnight","free","heavy","fragile"].map(e=>(0,a.jsx)(Z.eb,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)(eu.av,{value:"inventory",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,a.jsx)(em.d,{id:"trackInventory",checked:Y,onCheckedChange:G}),(0,a.jsx)(en.J,{htmlFor:"trackInventory",children:"Track Inventory"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"store",children:"Store *"}),(0,a.jsxs)(Z.l6,{value:eL,onValueChange:e=>{eV(e),h.store&&g(e=>({...e,store:void 0}))},disabled:eT,children:[(0,a.jsx)(Z.bq,{className:(0,R.cn)("w-full",h.store?"border-red-500":""),children:(0,a.jsx)(Z.yv,{placeholder:eT?"Loading stores...":"Select a store"})}),(0,a.jsx)(Z.gC,{children:eq.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:e.name},e.id))})]}),h.store&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:h.store}),0===eq.length&&!eT&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:"No stores available. Please create a store first."})]}),Y&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"stock",children:"Stock Quantity"}),(0,a.jsx)(B.p,{id:"stock",type:"number",value:O,onChange:e=>z(e.target.value),placeholder:"0 (optional)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"lowStockThreshold",children:"Low Stock Threshold"}),(0,a.jsx)(B.p,{id:"lowStockThreshold",type:"number",value:W,onChange:e=>H(e.target.value),placeholder:"10 (optional)"})]})]})]}),(0,a.jsxs)(eu.av,{value:"variations",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,a.jsx)(em.d,{id:"hasVariations",checked:eC,onCheckedChange:ek}),(0,a.jsx)(en.J,{htmlFor:"hasVariations",children:"This product has variations"})]}),eC&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Product Variants"}),(0,a.jsxs)(d.$,{onClick:()=>{eS([...eA,{id:Date.now().toString(),name:"",sku:"",price:E||"",cost:T||"",stock_quantity:"",is_active:!0,options:[],option_stocks:[],images:[],attributes:[]}])},variant:"outline",size:"sm",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Add Variant"]})]}),eA.length>0&&(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Variants:"})," ",eA.length]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Options:"})," ",eA.reduce((e,s)=>e+s.options.length,0)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Stock:"})," ",eA.reduce((e,s)=>e+Number(s.stock_quantity||0),0)]})]})}),eA.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h5",{className:"font-medium",children:["Variant ",s+1]}),(0,a.jsx)(d.$,{onClick:()=>sj(e.id),variant:"outline",size:"sm",children:(0,a.jsx)(ee.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"Variant Name"}),(0,a.jsx)(B.p,{value:e.name,onChange:s=>sv(e.id,"name",s.target.value),placeholder:"e.g. Red - Large"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"SKU"}),(0,a.jsx)(B.p,{value:e.sku,onChange:s=>sv(e.id,"sku",s.target.value),placeholder:"Variant SKU"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"Price"}),(0,a.jsx)(B.p,{type:"number",step:"0.01",value:e.price,onChange:s=>sv(e.id,"price",s.target.value),placeholder:"0.00"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"Cost"}),(0,a.jsx)(B.p,{type:"number",step:"0.01",value:e.cost,onChange:s=>sv(e.id,"cost",s.target.value),placeholder:"0.00"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"Stock Quantity"}),(0,a.jsx)(B.p,{type:"number",value:e.stock_quantity,onChange:s=>sv(e.id,"stock_quantity",s.target.value),placeholder:"0"})]}),(0,a.jsx)("div",{className:"space-y-2 flex items-center",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-6",children:[(0,a.jsx)(em.d,{checked:e.is_active,onCheckedChange:s=>sv(e.id,"is_active",s)}),(0,a.jsx)(en.J,{children:"Active"})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(en.J,{children:"Variant Options"}),(0,a.jsxs)(d.$,{onClick:()=>sN(e.id),variant:"outline",size:"sm",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-1"}),"Add Option"]})]}),e.options.map((s,t)=>(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(B.p,{value:s,onChange:s=>s_(e.id,t,s.target.value),placeholder:"e.g. Red, Large, Cotton",className:"flex-1"}),(0,a.jsx)(B.p,{type:"number",value:e.option_stocks.find(e=>e.option===s)?.stock||"",onChange:t=>sC(e.id,s,t.target.value),placeholder:"Stock",className:"w-20"}),(0,a.jsx)(d.$,{onClick:()=>sw(e.id,t),variant:"outline",size:"sm",children:(0,a.jsx)(ep.A,{className:"h-4 w-4"})})]},t))]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(en.J,{children:"Attributes"}),(0,a.jsxs)(d.$,{onClick:()=>sy(e.id),variant:"outline",size:"sm",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-1"}),"Add Attribute"]})]}),e.attributes.map((s,t)=>(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(B.p,{value:s.key,onChange:s=>sf(e.id,t,"key",s.target.value),placeholder:"Attribute name",className:"flex-1"}),(0,a.jsx)(B.p,{value:s.value,onChange:s=>sf(e.id,t,"value",s.target.value),placeholder:"Attribute value",className:"flex-1"}),(0,a.jsx)(d.$,{onClick:()=>sb(e.id,t),variant:"outline",size:"sm",children:(0,a.jsx)(ep.A,{className:"h-4 w-4"})})]},t))]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{children:"Variant Images"}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:s=>sk(e.id,s),className:"hidden",id:`variant-image-${e.id}`}),(0,a.jsxs)(d.$,{onClick:()=>document.getElementById(`variant-image-${e.id}`)?.click(),variant:"outline",size:"sm",children:[(0,a.jsx)(V.A,{className:"h-4 w-4 mr-1"}),"Add Images"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[e.images.length," image(s)"]})]}),e.images.length>0&&(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:e.images.map((t,r)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(ev.default,{src:t,alt:`Variant ${s+1} Image ${r+1}`,width:60,height:60,className:"rounded border object-cover"}),(0,a.jsx)(d.$,{onClick:()=>sA(e.id,r),variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",children:(0,a.jsx)(ep.A,{className:"h-3 w-3"})})]},r))})]})]},e.id))]})]}),(0,a.jsx)(eu.av,{value:"media",className:"space-y-6",children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(en.J,{className:"text-base font-medium",children:"Product Images"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload multiple images for your product. The first image will be used as the primary image."}),(0,a.jsxs)("div",{className:(0,R.cn)("border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",e_?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),ew(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),ew(!1)},onDrop:sx,onClick:()=>document.getElementById("image-upload")?.click(),children:[(0,a.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:sp,className:"hidden",id:"image-upload"}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)(eh.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Product Images"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:e_?"Drop your images here":"Drag and drop your images here, or click to browse"}),(0,a.jsxs)(d.$,{type:"button",variant:"outline",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)(V.A,{className:"h-4 w-4 mr-2"}),"Choose Images"]})]})]}),ej.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h4",{className:"font-medium",children:["Uploaded Images (",ej.length,")"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Click the star to set as primary image"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:ej.map((e,s)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("div",{className:"aspect-square rounded-lg overflow-hidden border-2 border-gray-200",children:(0,a.jsx)(ev.default,{src:e||"/placeholder.svg",alt:`Product image ${s+1}`,width:200,height:200,className:"w-full h-full object-cover"})}),s===eb&&(0,a.jsxs)(c.E,{className:"absolute top-2 left-2 bg-yellow-500 text-white",children:[(0,a.jsx)(eg.A,{className:"h-3 w-3 mr-1 fill-current"}),"Primary"]}),(0,a.jsxs)("div",{className:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center gap-2",children:[(0,a.jsxs)(d.$,{onClick:()=>sg(s),variant:"secondary",size:"sm",className:"text-xs",children:[(0,a.jsx)(eg.A,{className:(0,R.cn)("h-3 w-3 mr-1",s===eb&&"fill-current")}),s===eb?"Primary":"Set Primary"]}),(0,a.jsx)(d.$,{onClick:()=>sh(s),variant:"destructive",size:"sm",className:"text-xs",children:(0,a.jsx)(ee.A,{className:"h-3 w-3"})})]}),(0,a.jsx)("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded",children:s+1})]},s))})]}),0===ej.length&&(0,a.jsxs)("div",{className:"mt-4 text-center py-8 border border-gray-200 rounded-lg bg-gray-50",children:[(0,a.jsx)(V.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No images uploaded yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Upload at least one image to showcase your product"})]})]})})})]})}),(0,a.jsxs)("div",{className:"flex justify-between px-6 py-4 border-t",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.$,{variant:"outline",onClick:s,children:"Cancel"}),sD>0&&(0,a.jsx)(d.$,{variant:"outline",onClick:()=>{sD>0&&(x(v[sD-1]),g({}))},children:"Previous"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:sF?(0,a.jsx)(d.$,{onClick:sS,disabled:n,children:n?"Creating...":"Create Product"}):(0,a.jsx)(d.$,{onClick:()=>{sd(p)?sD<v.length-1&&(x(v[sD+1]),g({})):l({title:"Validation Error",description:"Please fill in all required fields before proceeding",variant:"destructive"})},children:"Next"})})]})]}),eB&&(0,a.jsxs)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>eZ(!1)}),(0,a.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-md p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Create Product Category"}),(0,a.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>eZ(!1),children:(0,a.jsx)(ep.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(en.J,{htmlFor:"newCategoryName",children:"Name *"}),(0,a.jsx)(B.p,{id:"newCategoryName",value:eW,onChange:e=>eH(e.target.value),placeholder:"e.g. Electronics"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(en.J,{htmlFor:"newCategoryDescription",children:"Description"}),(0,a.jsx)(eo.T,{id:"newCategoryDescription",value:eK,onChange:e=>eY(e.target.value),rows:2,placeholder:"Optional description"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(en.J,{htmlFor:"newCategoryColor",children:"Color"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(B.p,{id:"newCategoryColor",type:"color",className:"w-16 p-1 h-9",value:eG,onChange:e=>eQ(e.target.value)}),(0,a.jsx)(B.p,{value:eG,onChange:e=>eQ(e.target.value),className:"flex-1"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 pt-1",children:[(0,a.jsx)(em.d,{id:"newCategoryActive",checked:eX,onCheckedChange:e0}),(0,a.jsx)(en.J,{htmlFor:"newCategoryActive",children:"Active"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)(d.$,{variant:"outline",onClick:()=>eZ(!1),children:"Cancel"}),(0,a.jsx)(d.$,{onClick:sE,disabled:e1||!eW.trim(),children:e1?"Saving...":"Create"})]})]})]})]}):null}var eb=t(8819),eN=t(72840),e_=t(27605),ew=t(63442),eC=t(99756),ek=t(58164),eA=t(17073);let eS=eC.Ik({reference_number:eC.Yj().nonempty({message:"Reference number is required"}),store_id:eC.Yj().nonempty({message:"Store is required"}),document_type:eC.k5(["receipt","invoice","delivery_note"]),items:eC.YO(eC.Ik({product_id:eC.Yj().nonempty({message:"Product is required"}),variant_id:eC.Yj().optional().nullable(),quantity:eC.ai().positive({message:"Quantity must be greater than 0"}),unit_price:eC.ai().min(0,{message:"Unit price must be greater than or equal to 0"}),expiry_date:eC.Yj().optional().nullable(),notes:eC.Yj().optional().nullable(),enable_batch_tracking:eC.zM().optional(),batch_number:eC.Yj().optional(),lot_number:eC.Yj().optional(),serial_number:eC.Yj().optional(),manufacture_date:eC.Yj().optional(),individual_serials:eC.YO(eC.Yj()).optional()}))});function eP({open:e,onOpenChange:s,onSuccess:t}){let{toast:l}=(0,i.dj)(),[o,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[g,v]=(0,r.useState)(""),[j,f]=(0,r.useState)("receipt"),[b,N]=(0,r.useState)(""),[w,k]=(0,r.useState)(""),[S,P]=(0,r.useState)(null),[F,E]=(0,r.useState)(""),[I,q]=(0,r.useState)(""),[L,V]=(0,r.useState)(""),[T,J]=(0,r.useState)(""),[U,M]=(0,r.useState)(""),[O,z]=(0,r.useState)(""),[W,Y]=(0,r.useState)(""),[G,Q]=(0,r.useState)(""),[X,es]=(0,r.useState)([]),[et,ea]=(0,r.useState)([]),[er,ei]=(0,r.useState)([]),[el,ed]=(0,r.useState)([]),[eo,em]=(0,r.useState)([]),[eu,eg]=(0,r.useState)(!1),[ev,ej]=(0,r.useState)(!1),[ey,eC]=(0,r.useState)(!1),[eP,eD]=(0,r.useState)(!1),[eF,eE]=(0,r.useState)(""),[eI,eR]=(0,r.useState)(!1),[eq,e$]=(0,r.useState)(null),[eL,eV]=(0,r.useState)(!1),[eT,eJ]=(0,r.useState)(!1),[eU,eM]=(0,r.useState)(null),{hasPermission:eO,isAdmin:ez}=(0,eA.S)(),eB=(0,e_.mN)({resolver:(0,ew.u)(eS),mode:"onSubmit",defaultValues:{reference_number:"",store_id:"",document_type:"receipt",items:[]}}),eZ=async()=>{eC(!0);try{let{data:e}=await (0,ec.d$)(1,1e3);ei(e)}catch(e){l({title:"Error",description:"Failed to load products",variant:"destructive"})}finally{eC(!1)}},eW=()=>{let e=[...eo,{id:Date.now().toString(),product_id:"",variant_id:null,quantity:1,unit_price:0,expiry_date:null,notes:null}];em(e),eB.setValue("items",e)},eH=e=>{let s=eo.filter(s=>s.id!==e);em(s),eB.setValue("items",s)},eK=(e,s,t)=>{let a=eo.map(a=>{if(a.id===e){let e={...a,[s]:t};if("product_id"===s){let s=er.find(e=>e.id===t);e.product=s,e.variant_id=null,e.variant=null,s&&(e.unit_price=parseFloat((s.price||0).toString())),e.quantity&&void 0!==e.individual_serials&&(e.individual_serials=Array(e.quantity).fill(""))}if("variant_id"===s&&t){let s=e.product;if(s&&s.variants){let a=s.variants.find(e=>e.id===t);a&&(e.variant=a,e.unit_price=parseFloat((a.price||s.price||0).toString()))}}if("quantity"===s&&void 0!==e.individual_serials){let s=e.individual_serials||[];t>s.length?e.individual_serials=[...s,...Array(t-s.length).fill("")]:t<s.length&&(e.individual_serials=s.slice(0,t))}return e}return a});em(a),eB.setValue("items",a)},eY=(e,s)=>{let t,a=eo.find(t=>t.product_id===e.id&&t.variant_id===(s?.id||null));em(t=a?eo.map(e=>e.id===a.id?{...e,quantity:e.quantity+1}:e):[...eo,{id:Date.now().toString(),product_id:e.id,variant_id:s?.id||null,quantity:1,unit_price:parseFloat((s?.price||e.price||0).toString()),expiry_date:null,notes:null,product:e,variant:s}]),eB.setValue("items",t),eE(""),eR(!1)},eG=e=>{e.has_variations&&e.variants&&e.variants.length>0?(e$(e),eV(!0)):eY(e)},eQ=()=>{eM({referenceNumber:g,documentType:j,supplierId:b,storeId:w,document:S,items:eo}),eJ(!0)},eX=async()=>{try{await eZ(),l({title:"Success! ",description:"Product created successfully. You can now add it to the receipt."}),eJ(!1)}catch(e){l({title:"Error",description:"Failed to refresh products list",variant:"destructive"})}},e0=()=>{if(!g.trim())return l({title:"Validation Error",description:"Reference number is required",variant:"destructive"}),!1;if(!w)return l({title:"Validation Error",description:"Please select a store",variant:"destructive"}),!1;if(0===eo.length)return l({title:"Validation Error",description:"Please add at least one product item",variant:"destructive"}),!1;for(let e of eo){if(!e.product_id||"select-product"===e.product_id)return l({title:"Validation Error",description:"All items must have a product selected",variant:"destructive"}),!1;if(e.product&&e.product.has_variations&&e.product.variants&&e.product.variants.length>0&&(!e.variant_id||"select-variant"===e.variant_id))return l({title:"Validation Error",description:`Please select a variant for "${e.product.name}"`,variant:"destructive"}),!1;if(e.quantity<=0)return l({title:"Validation Error",description:"All items must have a quantity greater than 0",variant:"destructive"}),!1;if(e.unit_price<0)return l({title:"Validation Error",description:"Unit prices cannot be negative",variant:"destructive"}),!1}return!0};async function e1(e){if(!eO("can_create_product_receipts")&&!ez())return void l({title:"Access Denied",description:"You do not have permission to create product receipts.",variant:"destructive"});if(e0()){h(!0);try{let e={supplier_id:b&&"none"!==b?b:null,contractor_id:null,document_type:j,reference_number:g.trim(),store_id:w,items:eo.map(e=>({product_id:e.product_id,variant_id:e.variant_id,quantity:e.quantity,unit_price:e.unit_price,expiry_date:e.expiry_date,notes:e.notes,...e.enable_batch_tracking&&{batch_number:e.batch_number||void 0,lot_number:e.lot_number||void 0,serial_number:e.serial_number||void 0,manufacture_date:e.manufacture_date||void 0,individual_serials:e.individual_serials||void 0}})),document:S,...F&&{container_number:F.trim()},...I&&{driver_name:I.trim()},...L&&{driver_id_number:L.trim()},...T&&{driver_phone:T.trim()},...U&&{vehicle_number_plate:U.trim()},...O&&{vehicle_description:O.trim()},...W&&{receipt_date:W},...G&&{landed_date:G}};await p(e),l({title:"Success! ",description:"Product receipt created successfully"}),s(!1),t?.()}catch(e){l({title:"Error",description:e.message||"Failed to create product receipt",variant:"destructive"})}finally{h(!1)}}}let e2=er.filter(e=>e.name.toLowerCase().includes(eF.toLowerCase())||e.sku?.toLowerCase().includes(eF.toLowerCase())),e4=eo.reduce((e,s)=>e+s.quantity*s.unit_price,0);return(0,a.jsx)(n.cj,{open:e,onOpenChange:s,children:(0,a.jsxs)(n.h,{side:"right",className:"w-full sm:max-w-4xl flex flex-col h-full p-0",children:[(0,a.jsxs)(n.Fm,{className:"px-6 py-4 border-b bg-white sticky top-0 z-10",children:[(0,a.jsx)(n.qp,{children:"Create Product Receipt"}),(0,a.jsx)(n.Qs,{children:"Add a new product receipt to the system"})]}),(0,a.jsx)(ek.lV,{...eB,children:(0,a.jsx)("form",{onSubmit:eB.handleSubmit(e1),className:"flex flex-col flex-1 overflow-hidden",children:eO("can_create_product_receipts")||ez()?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"referenceNumber",children:"Reference Number *"}),(0,a.jsx)(B.p,{id:"referenceNumber",value:g,onChange:e=>{v(e.target.value),eB.setValue("reference_number",e.target.value)},placeholder:"e.g., DOC-REF-001",disabled:x})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"documentType",children:"Document Type"}),(0,a.jsxs)(Z.l6,{value:j,onValueChange:e=>{f(e),eB.setValue("document_type",e)},disabled:x,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"receipt",children:"Receipt"}),(0,a.jsx)(Z.eb,{value:"invoice",children:"Invoice"}),(0,a.jsx)(Z.eb,{value:"delivery_note",children:"Delivery Note"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"store",children:"Store *"}),(0,a.jsxs)(Z.l6,{value:w,onValueChange:e=>{k(e),eB.setValue("store_id",e)},disabled:x||eu,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{placeholder:eu?"Loading stores...":"Select store"})}),(0,a.jsx)(Z.gC,{children:X.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"document",children:"Document (Optional)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(B.p,{type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:e=>{let s=e.target.files?.[0];if(s){if(s.size>5242880)return void l({title:"File too large",description:"Please select a file smaller than 5MB",variant:"destructive"});P(s)}},disabled:x,className:"hidden",id:"document-upload"}),(0,a.jsxs)(d.$,{type:"button",variant:"outline",onClick:()=>window.document.getElementById("document-upload")?.click(),disabled:x,className:"w-full",children:[(0,a.jsx)(eh.A,{className:"h-4 w-4 mr-2"}),S?S.name:"Upload Document"]}),S&&(0,a.jsx)(d.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>P(null),disabled:x,children:(0,a.jsx)(ep.A,{className:"h-4 w-4"})})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"supplier",children:"Supplier (Optional)"}),(0,a.jsxs)(Z.l6,{value:b||"none",onValueChange:e=>{N("none"===e?"":e)},disabled:x||ev,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{placeholder:ev?"Loading suppliers...":"Select supplier"})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"none",children:"No supplier"}),et.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:e.name},e.id))]})]})]})}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 text-indigo-600"}),"Logistics & Delivery Details",(0,a.jsx)(c.E,{variant:"secondary",className:"ml-2 text-xs",children:"Optional"})]})}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(A,{className:"h-4 w-4"}),"Shipping Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"containerNumber",children:"Container Number"}),(0,a.jsx)(B.p,{id:"containerNumber",value:F,onChange:e=>E(e.target.value),placeholder:"e.g., CONT123456789",disabled:x,maxLength:100})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"landedDate",children:"Landed Date"}),(0,a.jsx)(B.p,{id:"landedDate",type:"date",value:G,onChange:e=>Q(e.target.value),disabled:x})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"receiptDate",children:"Receipt Date"}),(0,a.jsx)(B.p,{id:"receiptDate",type:"date",value:W,onChange:e=>Y(e.target.value),disabled:x})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4"}),"Driver Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"driverName",children:"Driver Name"}),(0,a.jsx)(B.p,{id:"driverName",value:I,onChange:e=>q(e.target.value),placeholder:"e.g., John Doe",disabled:x,maxLength:100})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"driverIdNumber",children:"ID Number"}),(0,a.jsx)(B.p,{id:"driverIdNumber",value:L,onChange:e=>V(e.target.value),placeholder:"e.g., ID12345678",disabled:x,maxLength:50})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"driverPhone",children:"Phone Number"}),(0,a.jsx)(B.p,{id:"driverPhone",value:T,onChange:e=>J(e.target.value),placeholder:"e.g., +254712345678",disabled:x,maxLength:20})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(D,{className:"h-4 w-4"}),"Vehicle Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"vehicleNumberPlate",children:"Number Plate"}),(0,a.jsx)(B.p,{id:"vehicleNumberPlate",value:U,onChange:e=>M(e.target.value),placeholder:"e.g., KAA 123A",disabled:x,maxLength:20})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"vehicleDescription",children:"Vehicle Description"}),(0,a.jsx)(B.p,{id:"vehicleDescription",value:O,onChange:e=>z(e.target.value),placeholder:"e.g., White Toyota Hilux",disabled:x,maxLength:255})]})]})]})]})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-purple-600"}),"Product Items",eo.length>0&&(0,a.jsxs)(c.E,{variant:"secondary",className:"ml-2",children:[eo.length," ",1===eo.length?"item":"items"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:eW,disabled:x,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Add Manually"]}),(0,a.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:eQ,disabled:x,className:"text-green-600 border-green-200 hover:bg-green-50",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Create Product"]})]})]})}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(H.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)(en.J,{className:"text-sm font-medium text-gray-700",children:"Quick Add Products"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(B.p,{id:"productSearch",type:"text",placeholder:"Search by product name or SKU to quickly add...",value:eF,onChange:e=>{eE(e.target.value),eR(e.target.value.length>0)},onFocus:()=>eR(eF.length>0),className:"bg-white",disabled:x||ey}),eI&&eF.length>0&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 z-[200] mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:ey?(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Loading products..."]})}):e2.length>0?(0,a.jsxs)(a.Fragment,{children:[e2.map(e=>(0,a.jsxs)("button",{type:"button",className:"w-full text-left p-4 hover:bg-blue-50 border-b border-gray-100 last:border-0 flex items-center justify-between transition-colors",onClick:()=>eG(e),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1 flex items-center gap-3",children:[(0,a.jsxs)("span",{children:["SKU: ",e.sku||"N/A"]}),(0,a.jsxs)("span",{children:["Stock: ",e.stock_quantity||0]}),e.has_variations&&e.variants&&e.variants.length>0&&(0,a.jsxs)(c.E,{variant:"secondary",className:"text-xs",children:[e.variants.length," variants"]})]})]}),(0,a.jsxs)("div",{className:"text-right ml-4",children:[(0,a.jsx)("div",{className:"font-bold text-green-600",children:(0,R.vv)(e.price||0)}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Click to add"})]})]},e.id)),(0,a.jsx)("div",{className:"border-t border-gray-100",children:(0,a.jsxs)("button",{type:"button",className:"w-full text-left p-4 hover:bg-blue-50 text-blue-600 font-medium flex items-center gap-2 transition-colors",onClick:eQ,children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),"Create new product"]})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,a.jsxs)("div",{className:"mb-2",children:['No products found for "',eF,'"']}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Try a different search term or create a new product"})]}),(0,a.jsx)("div",{className:"border-t border-gray-100",children:(0,a.jsxs)("button",{type:"button",className:"w-full text-left p-4 hover:bg-blue-50 text-blue-600 font-medium flex items-center gap-2 transition-colors",onClick:eQ,children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),'Create "',eF,'" as new product']})})]})})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:'\uD83D\uDCA1 Tip: Start typing to search products, or use "Add Manually" to configure items step by step'})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===eo.length?(0,a.jsxs)("div",{className:"text-center py-12 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[(0,a.jsx)(y.A,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"No items added yet"}),(0,a.jsx)("p",{className:"text-sm mb-4",children:"Add products using the search above or manually configure items"}),(0,a.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,a.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:eW,disabled:o,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Add First Item"]})})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[eo.map((e,s)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white hover:shadow-sm transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-100 text-blue-700 rounded-full w-8 h-8 flex items-center justify-center text-sm font-semibold",children:s+1}),e.product&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.product?.name||e.product_id}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.variant&&(0,a.jsx)(c.E,{variant:"outline",className:"text-xs",children:e.variant?.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["SKU: ",e.product.sku||"N/A"]})]})]})]}),(0,a.jsx)(d.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>eH(e.id),disabled:x,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(ee.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,a.jsx)("input",{type:"checkbox",id:`batch-tracking-${e.id}`,checked:e.enable_batch_tracking||!1,onChange:s=>eK(e.id,"enable_batch_tracking",s.target.checked),disabled:x,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)(en.J,{htmlFor:`batch-tracking-${e.id}`,className:"text-sm font-medium text-gray-700",children:"\uD83D\uDCE6 Enable Batch Tracking"})]}),e.enable_batch_tracking&&(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200 space-y-3",children:[(0,a.jsxs)("h4",{className:"font-medium text-blue-800 flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4"}),"Batch Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Batch Number"}),(0,a.jsx)(B.p,{placeholder:"Auto-generated if empty",value:e.batch_number||"",onChange:s=>eK(e.id,"batch_number",s.target.value),disabled:x,className:"h-9"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Lot Number"}),(0,a.jsx)(B.p,{placeholder:"Supplier lot number",value:e.lot_number||"",onChange:s=>eK(e.id,"lot_number",s.target.value),disabled:x,className:"h-9"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Manufacture Date"}),(0,a.jsx)(B.p,{type:"date",value:e.manufacture_date||"",onChange:s=>eK(e.id,"manufacture_date",s.target.value),disabled:x,className:"h-9"})]}),(0,a.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Expiry Date"}),(0,a.jsx)(B.p,{type:"date",value:e.expiry_date||"",onChange:s=>eK(e.id,"expiry_date",s.target.value),disabled:x,className:"h-9"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,a.jsx)("input",{type:"checkbox",id:`individual-serials-${e.id}`,checked:void 0!==e.individual_serials,onChange:s=>{if(s.target.checked){let s=Array(e.quantity).fill("");eK(e.id,"individual_serials",s)}else eK(e.id,"individual_serials",void 0)},disabled:x,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)(en.J,{htmlFor:`individual-serials-${e.id}`,className:"text-sm font-medium text-gray-700",children:"\uD83D\uDCCB Add Individual Serial Numbers for Items"})]}),void 0!==e.individual_serials&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(en.J,{className:"text-sm font-medium",children:["Individual Serial Numbers (",e.quantity," items)"]}),(0,a.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto p-2 bg-white rounded border",children:Array.from({length:e.quantity},(s,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500 w-8",children:["#",t+1]}),(0,a.jsx)(B.p,{type:"text",placeholder:`Serial #${t+1}`,value:e.individual_serials?.[t]||"",onChange:s=>{let a=[...e.individual_serials||Array(e.quantity).fill("")];a[t]=s.target.value,eK(e.id,"individual_serials",a)},disabled:x,className:"h-8 text-sm"})]},t))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Product *"}),(0,a.jsxs)(Z.l6,{value:e.product_id||"select-product",onValueChange:s=>{eK(e.id,"product_id",s);let t=[...eo],a=t.findIndex(s=>s.id===e.id);-1!==a&&(t[a]={...t[a],product_id:s},eB.setValue("items",t))},disabled:x,children:[(0,a.jsx)(Z.bq,{className:"h-10",children:(0,a.jsx)(Z.yv,{placeholder:"Select product"})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"select-product",disabled:!0,children:"Select product"}),er.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["SKU: ",e.sku||"N/A"]})]})},e.id)),(0,a.jsx)("div",{className:"border-t my-1"}),(0,a.jsxs)(d.$,{type:"button",variant:"ghost",className:"w-full justify-start text-left text-sm",onClick:eQ,children:[(0,a.jsx)(ex.A,{className:"h-4 w-4 mr-2"})," Create Product"]})]})]})]}),e.product&&e.product.has_variations&&e.product.variants&&e.product.variants.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Variant *"}),(0,a.jsxs)(Z.l6,{value:e.variant_id||"select-variant",onValueChange:s=>{eK(e.id,"variant_id",s);let t=[...eo],a=t.findIndex(s=>s.id===e.id);-1!==a&&(t[a]={...t[a],variant_id:s},eB.setValue("items",t))},disabled:x,children:[(0,a.jsx)(Z.bq,{className:"h-10",children:(0,a.jsx)(Z.yv,{placeholder:"Select variant"})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"select-variant",disabled:!0,children:"Select variant"}),e.product.variants.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Qty *"}),(0,a.jsx)(B.p,{type:"number",min:"1",step:"1",value:e.quantity,onChange:s=>{let t=parseInt(s.target.value)||0;eK(e.id,"quantity",t);let a=[...eo],r=a.findIndex(s=>s.id===e.id);-1!==r&&(a[r]={...a[r],quantity:t},eB.setValue("items",a))},disabled:x,className:"h-10"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Unit Price"}),(0,a.jsx)(B.p,{type:"number",min:"0",step:"0.01",value:e.unit_price,onChange:s=>{let t=parseFloat(s.target.value)||0;eK(e.id,"unit_price",t);let a=[...eo],r=a.findIndex(s=>s.id===e.id);-1!==r&&(a[r]={...a[r],unit_price:t},eB.setValue("items",a))},disabled:x,className:"h-10"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Expiry Date (Optional)"}),(0,a.jsx)(B.p,{type:"date",value:e.expiry_date||"",onChange:s=>eK(e.id,"expiry_date",s.target.value||null),disabled:x,className:"h-10"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Notes (Optional)"}),(0,a.jsx)(B.p,{value:e.notes||"",onChange:s=>eK(e.id,"notes",s.target.value||null),placeholder:"Additional notes...",disabled:x,className:"h-10"})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Item Total"}),(0,a.jsx)("div",{className:"text-lg font-bold text-green-600",children:(0,R.vv)(e.quantity*e.unit_price)})]})})]},e.id)),(0,a.jsx)("div",{className:"flex justify-center pt-2",children:(0,a.jsxs)(d.$,{type:"button",variant:"outline",onClick:eW,disabled:o,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Add Another Item"]})})]})}),eo.length>0&&(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 border border-green-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"Receipt Summary"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[eo.length," ",1===eo.length?"item":"items","  Total Quantity: ",eo.reduce((e,s)=>e+s.quantity,0)," units"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Value"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(0,R.vv)(e4)})]})]})})]})]})]}),(0,a.jsxs)(n.XW,{className:"px-6 py-4 border-t bg-white sticky bottom-0",children:[(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:x,children:"Cancel"}),(0,a.jsx)(d.$,{type:"submit",disabled:x,children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eb.A,{className:"mr-2 h-4 w-4"}),"Create Receipt"]})})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-6",children:[(0,a.jsx)(eN.A,{className:"h-12 w-12 text-red-500 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsxs)("p",{className:"text-gray-500 text-center",children:["You do not have permission to create product receipts.",(0,a.jsx)("br",{}),"Please contact your administrator to request access."]})]})})}),(0,a.jsx)(ef,{isOpen:eT,onClose:()=>eJ(!1),onSuccess:eX})]})})}let eD=eC.Ik({reference_number:eC.Yj().nonempty({message:"Reference number is required"}),store_id:eC.Yj().nonempty({message:"Store is required"}),document_type:eC.k5(["receipt","invoice","delivery_note"]),supplier_id:eC.Yj().optional().nullable(),items:eC.YO(eC.Ik({product_id:eC.Yj().nonempty({message:"Product is required"}),variant_id:eC.Yj().optional().nullable(),quantity:eC.ai().positive({message:"Quantity must be greater than 0"}),unit_price:eC.ai().min(0,{message:"Unit price must be greater than or equal to 0"}),expiry_date:eC.Yj().optional().nullable(),notes:eC.Yj().optional().nullable()}))});function eF({open:e,onOpenChange:s,onSuccess:t,productReceipt:l}){let{toast:o}=(0,i.dj)(),[u,p]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[g,j]=(0,r.useState)(""),[f,b]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),[k,S]=(0,r.useState)(""),[P,F]=(0,r.useState)(null),[E,I]=(0,r.useState)([]),[q,L]=(0,r.useState)(""),[V,T]=(0,r.useState)(""),[J,U]=(0,r.useState)(""),[M,O]=(0,r.useState)(""),[z,W]=(0,r.useState)(""),[Y,G]=(0,r.useState)(""),[Q,X]=(0,r.useState)(""),[es,et]=(0,r.useState)(""),[ea,er]=(0,r.useState)([]),[ei,el]=(0,r.useState)([]),[ec,ed]=(0,r.useState)([]),[eo,em]=(0,r.useState)(null),[eu,eg]=(0,r.useState)(!1),[ev,ej]=(0,r.useState)(!1),[ey,ef]=(0,r.useState)(!1),[eC,eS]=(0,r.useState)(""),[eP,eF]=(0,r.useState)(!1),[eE,eI]=(0,r.useState)(null),[eR,eq]=(0,r.useState)(!1),[e$,eL]=(0,r.useState)(!1),{hasPermission:eV,isAdmin:eT}=(0,eA.S)(),eJ=(0,e_.mN)({resolver:(0,ew.u)(eD),defaultValues:{reference_number:"",store_id:"",document_type:"receipt",supplier_id:"",items:[]}}),eU=()=>{I([...E,{id:Date.now().toString(),product_id:"",variant_id:null,quantity:1,unit_price:0,expiry_date:null,notes:null}])},eM=e=>{I(E.filter(s=>s.id!==e))},eO=(e,s,t)=>{I(E.map(a=>{if(a.id===e){let e={...a,[s]:t};if("product_id"===s){let s=ec.find(e=>e.id===t);e.product=s,e.variant_id=null,e.variant=null,s&&(e.unit_price=parseFloat(String(s.price||0)))}if("variant_id"===s&&t){let s=e.product;if(s&&s.variants){let a=s.variants.find(e=>e.id===t);a&&(e.variant=a,e.unit_price=parseFloat(String(a.price||s.price||0)))}}return e}return a}))},ez=(e,s)=>{let t=E.find(t=>t.product_id===e.id&&t.variant_id===(s?.id||null));t?eO(t.id,"quantity",t.quantity+1):I([...E,{id:Date.now().toString(),product_id:e.id,variant_id:s?.id||null,quantity:1,unit_price:parseFloat(String(s?.price||e.price||0)),expiry_date:null,notes:null,product:e,variant:s}]),eS(""),eF(!1)},eB=e=>{e.has_variations&&e.variants&&e.variants.length>0?(eI(e),eq(!0)):ez(e)},eZ=()=>{eL(!0)};async function eW(e){if(l){if(!eV("can_update_product_receipts")&&!eT())return void o({title:"Access Denied",description:"You do not have permission to update product receipts.",variant:"destructive"});h(!0);try{let a={supplier_id:e.supplier_id||null,contractor_id:null,document_type:e.document_type,reference_number:e.reference_number.trim(),store_id:e.store_id,items:E.map(e=>({product_id:e.product_id,variant_id:e.variant_id,quantity:e.quantity,unit_price:e.unit_price,expiry_date:e.expiry_date,notes:e.notes})),document:P,container_number:q.trim()||null,driver_name:V.trim()||null,driver_id_number:J.trim()||null,driver_phone:M.trim()||null,vehicle_number_plate:z.trim()||null,vehicle_description:Y.trim()||null,receipt_date:Q||null,landed_date:es||null};await v(l.id,a),o({title:"Success! ",description:"Product receipt updated successfully"}),s(!1),t()}catch(e){o({title:"Error",description:e.message||"Failed to update product receipt",variant:"destructive"})}finally{h(!1)}}}let eH=ec.filter(e=>e.name.toLowerCase().includes(eC.toLowerCase())||e.sku?.toLowerCase().includes(eC.toLowerCase())),eK=E.reduce((e,s)=>e+s.quantity*s.unit_price,0);return l?(0,a.jsx)(n.cj,{open:e,onOpenChange:s,children:(0,a.jsxs)(n.h,{side:"right",className:"w-full sm:max-w-4xl flex flex-col h-full p-0",children:[(0,a.jsxs)(n.Fm,{className:"px-6 py-4 border-b bg-white sticky top-0 z-10",children:[(0,a.jsx)(n.qp,{children:"Edit Product Receipt"}),(0,a.jsx)(n.Qs,{children:"Update the product receipt details"})]}),(0,a.jsx)(ek.lV,{...eJ,children:(0,a.jsx)("form",{onSubmit:eJ.handleSubmit(eW),className:"flex flex-col flex-1 overflow-hidden",children:eV("can_update_product_receipts")||eT()?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"referenceNumber",children:"Reference Number *"}),(0,a.jsx)(B.p,{id:"referenceNumber",value:g,onChange:e=>j(e.target.value),placeholder:"e.g., DOC-REF-001",disabled:x})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"documentType",children:"Document Type"}),(0,a.jsxs)(Z.l6,{value:f,onValueChange:b,disabled:x,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"receipt",children:"Receipt"}),(0,a.jsx)(Z.eb,{value:"invoice",children:"Invoice"}),(0,a.jsx)(Z.eb,{value:"delivery_note",children:"Delivery Note"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"store",children:"Store *"}),(0,a.jsxs)(Z.l6,{value:k,onValueChange:S,disabled:x||eu,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{placeholder:eu?"Loading stores...":"Select store"})}),(0,a.jsx)(Z.gC,{children:ea.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"document",children:"Document (Optional)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(B.p,{type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:e=>{let s=e.target.files?.[0];if(s){if(s.size>5242880)return void o({title:"File too large",description:"Please select a file smaller than 5MB",variant:"destructive"});F(s)}},disabled:x,className:"hidden",id:"document-upload"}),(0,a.jsxs)(d.$,{type:"button",variant:"outline",onClick:()=>window.document.getElementById("document-upload")?.click(),disabled:x,className:"w-full",children:[(0,a.jsx)(eh.A,{className:"h-4 w-4 mr-2"}),P?P.name:"Upload Document"]}),P&&(0,a.jsx)(d.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>F(null),disabled:x,children:(0,a.jsx)(ep.A,{className:"h-4 w-4"})})]})]})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-5 w-5 text-green-600"}),"Supplier (Optional)"]})}),(0,a.jsx)(m.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"supplier",children:"Supplier"}),(0,a.jsxs)(Z.l6,{value:N||"none",onValueChange:e=>w("none"===e?"":e),disabled:x||ev,children:[(0,a.jsx)(Z.bq,{children:(0,a.jsx)(Z.yv,{placeholder:ev?"Loading suppliers...":"Select supplier"})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"none",children:"No supplier"}),ei.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:e.name},e.id))]})]})]})})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 text-indigo-600"}),"Logistics & Delivery Details",(0,a.jsx)(c.E,{variant:"secondary",className:"ml-2 text-xs",children:"Optional"})]})}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(A,{className:"h-4 w-4"}),"Shipping Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"containerNumber",children:"Container Number"}),(0,a.jsx)(B.p,{id:"containerNumber",value:q,onChange:e=>L(e.target.value),placeholder:"e.g., CONT123456789",disabled:x,maxLength:100})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"landedDate",children:"Landed Date"}),(0,a.jsx)(B.p,{id:"landedDate",type:"date",value:es,onChange:e=>et(e.target.value),disabled:x})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"receiptDate",children:"Receipt Date"}),(0,a.jsx)(B.p,{id:"receiptDate",type:"date",value:Q,onChange:e=>X(e.target.value),disabled:x})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(_.A,{className:"h-4 w-4"}),"Driver Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"driverName",children:"Driver Name"}),(0,a.jsx)(B.p,{id:"driverName",value:V,onChange:e=>T(e.target.value),placeholder:"e.g., John Doe",disabled:x,maxLength:100})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"driverIdNumber",children:"ID Number"}),(0,a.jsx)(B.p,{id:"driverIdNumber",value:J,onChange:e=>U(e.target.value),placeholder:"e.g., ID12345678",disabled:x,maxLength:50})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"driverPhone",children:"Phone Number"}),(0,a.jsx)(B.p,{id:"driverPhone",value:M,onChange:e=>O(e.target.value),placeholder:"e.g., +254712345678",disabled:x,maxLength:20})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 border-b pb-2",children:[(0,a.jsx)(D,{className:"h-4 w-4"}),"Vehicle Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"vehicleNumberPlate",children:"Number Plate"}),(0,a.jsx)(B.p,{id:"vehicleNumberPlate",value:z,onChange:e=>W(e.target.value),placeholder:"e.g., KAA 123A",disabled:x,maxLength:20})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{htmlFor:"vehicleDescription",children:"Vehicle Description"}),(0,a.jsx)(B.p,{id:"vehicleDescription",value:Y,onChange:e=>G(e.target.value),placeholder:"e.g., White Toyota Hilux",disabled:x,maxLength:255})]})]})]})]})]}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-purple-600"}),"Product Items",E.length>0&&(0,a.jsxs)(c.E,{variant:"secondary",className:"ml-2",children:[E.length," ",1===E.length?"item":"items"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:eU,disabled:x,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Add Manually"]}),(0,a.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:eZ,disabled:x,className:"text-green-600 border-green-200 hover:bg-green-50",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Create Product"]})]})]})}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(H.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)(en.J,{className:"text-sm font-medium text-gray-700",children:"Quick Add Products"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(B.p,{id:"productSearch",type:"text",placeholder:"Search by product name or SKU to quickly add...",value:eC,onChange:e=>{eS(e.target.value),eF(e.target.value.length>0)},onFocus:()=>eF(eC.length>0),className:"bg-white",disabled:x||ey}),eP&&eC.length>0&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 z-[200] mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:ey?(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Loading products..."]})}):eH.length>0?(0,a.jsxs)(a.Fragment,{children:[eH.map(e=>(0,a.jsxs)("button",{type:"button",className:"w-full text-left p-4 hover:bg-blue-50 border-b border-gray-100 last:border-0 flex items-center justify-between transition-colors",onClick:()=>eB(e),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1 flex items-center gap-3",children:[(0,a.jsxs)("span",{children:["SKU: ",e.sku||"N/A"]}),(0,a.jsxs)("span",{children:["Stock: ",e.stock_quantity||0]}),e.has_variations&&e.variants&&e.variants.length>0&&(0,a.jsxs)(c.E,{variant:"secondary",className:"text-xs",children:[e.variants.length," variants"]})]})]}),(0,a.jsxs)("div",{className:"text-right ml-4",children:[(0,a.jsx)("div",{className:"font-bold text-green-600",children:(0,R.vv)(e.price||0)}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Click to add"})]})]},e.id)),(0,a.jsx)("div",{className:"border-t border-gray-100",children:(0,a.jsxs)("button",{type:"button",className:"w-full text-left p-4 hover:bg-blue-50 text-blue-600 font-medium flex items-center gap-2 transition-colors",onClick:eZ,children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),"Create new product"]})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,a.jsxs)("div",{className:"mb-2",children:['No products found for "',eC,'"']}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Try a different search term or create a new product"})]}),(0,a.jsx)("div",{className:"border-t border-gray-100",children:(0,a.jsxs)("button",{type:"button",className:"w-full text-left p-4 hover:bg-blue-50 text-blue-600 font-medium flex items-center gap-2 transition-colors",onClick:eZ,children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),'Create "',eC,'" as new product']})})]})})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:'\uD83D\uDCA1 Tip: Start typing to search products, or use "Add Manually" to configure items step by step'})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===E.length?(0,a.jsxs)("div",{className:"text-center py-12 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[(0,a.jsx)(y.A,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"No items added yet"}),(0,a.jsx)("p",{className:"text-sm mb-4",children:"Add products using the search above or manually configure items"}),(0,a.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,a.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",onClick:eU,disabled:x,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Add First Item"]})})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[E.map((e,s)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white hover:shadow-sm transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-100 text-blue-700 rounded-full w-8 h-8 flex items-center justify-center text-sm font-semibold",children:s+1}),e.product&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.product?.name||e.product_id}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.variant&&(0,a.jsx)(c.E,{variant:"outline",className:"text-xs",children:e.variant?.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["SKU: ",e.product.sku||"N/A"]})]})]})]}),(0,a.jsx)(d.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>eM(e.id),disabled:x,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(ee.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Product *"}),(0,a.jsxs)(Z.l6,{value:e.product_id||"select-product",onValueChange:s=>eO(e.id,"product_id",s),disabled:x,children:[(0,a.jsx)(Z.bq,{className:"h-10",children:(0,a.jsx)(Z.yv,{placeholder:"Select product"})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"select-product",disabled:!0,children:"Select product"}),ec.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["SKU: ",e.sku||"N/A"]})]})},e.id)),(0,a.jsx)("div",{className:"border-t my-1"}),(0,a.jsxs)(d.$,{type:"button",variant:"ghost",className:"w-full justify-start text-left text-sm",onClick:eZ,children:[(0,a.jsx)(ex.A,{className:"h-4 w-4 mr-2"})," Create Product"]})]})]})]}),e.product&&e.product.has_variations&&e.product.variants&&e.product.variants.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Variant *"}),(0,a.jsxs)(Z.l6,{value:e.variant_id||"select-variant",onValueChange:s=>eO(e.id,"variant_id",s),disabled:x,children:[(0,a.jsx)(Z.bq,{className:"h-10",children:(0,a.jsx)(Z.yv,{placeholder:"Select variant"})}),(0,a.jsxs)(Z.gC,{children:[(0,a.jsx)(Z.eb,{value:"select-variant",disabled:!0,children:"Select variant"}),e.product.variants.map(e=>(0,a.jsx)(Z.eb,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Qty *"}),(0,a.jsx)(B.p,{type:"number",min:"1",step:"1",value:e.quantity,onChange:s=>eO(e.id,"quantity",parseInt(s.target.value)||0),disabled:x,className:"h-10"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Unit Price"}),(0,a.jsx)(B.p,{type:"number",min:"0",step:"0.01",value:e.unit_price,onChange:s=>eO(e.id,"unit_price",parseFloat(s.target.value)||0),disabled:x,className:"h-10"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Expiry Date (Optional)"}),(0,a.jsx)(B.p,{type:"date",value:e.expiry_date||"",onChange:s=>eO(e.id,"expiry_date",s.target.value||null),disabled:x,className:"h-10"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(en.J,{className:"text-sm font-medium",children:"Notes (Optional)"}),(0,a.jsx)(B.p,{value:e.notes||"",onChange:s=>eO(e.id,"notes",s.target.value||null),placeholder:"Additional notes...",disabled:x,className:"h-10"})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Item Total"}),(0,a.jsx)("div",{className:"text-lg font-bold text-green-600",children:(0,R.vv)(e.quantity*e.unit_price)})]})})]},e.id)),(0,a.jsx)("div",{className:"flex justify-center pt-2",children:(0,a.jsxs)(d.$,{type:"button",variant:"outline",onClick:eU,disabled:x,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Add Another Item"]})})]})}),E.length>0&&(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 border border-green-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"Receipt Summary"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[E.length," ",1===E.length?"item":"items","  Total Quantity: ",E.reduce((e,s)=>e+s.quantity,0)," units"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Value"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(0,R.vv)(eK)})]})]})})]})]})]}),(0,a.jsxs)(n.XW,{className:"px-6 py-4 border-t bg-white sticky bottom-0",children:[(0,a.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:x,children:"Cancel"}),(0,a.jsx)(d.$,{type:"submit",disabled:x,children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eb.A,{className:"mr-2 h-4 w-4"}),"Update Receipt"]})})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center px-6",children:[(0,a.jsx)(eN.A,{className:"h-12 w-12 text-red-500 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"You do not have permission to edit product receipts. Please contact your administrator for access."}),(0,a.jsx)(d.$,{className:"mt-4",onClick:()=>s(!1),children:"Close"})]})})})]})}):null}var eE=t(95033);function eI({open:e,onOpenChange:s,productReceipt:t,onSuccess:l}){let[n,c]=(0,r.useState)(!1),{toast:o}=(0,i.dj)(),{hasPermission:m,isAdmin:u}=(0,eA.S)();async function p(){if(t){if(!m("can_delete_product_receipts")&&!u())return void o({title:"Access Denied",description:"You do not have permission to delete product receipts.",variant:"destructive"});c(!0);try{await x(t.id),o({title:"Success",description:`Product receipt ${t.product_receipt_number||t.reference_number} has been deleted successfully.`}),l(),s(!1)}catch(e){console.error("Delete error:",e),o({title:"Error",description:e.message||"Failed to delete product receipt",variant:"destructive"})}finally{c(!1)}}}return(0,a.jsx)(eE.Lt,{open:e,onOpenChange:s,children:(0,a.jsxs)(eE.EO,{children:[(0,a.jsxs)(eE.wd,{children:[(0,a.jsx)(eE.r7,{children:"Are you sure?"}),(0,a.jsx)(eE.$v,{children:"This action cannot be undone. This will permanently delete the product receipt and remove all associated data."})]}),(0,a.jsxs)(eE.ck,{children:[(0,a.jsx)(eE.Zr,{disabled:n,children:"Cancel"}),m("can_delete_product_receipts")||u()?(0,a.jsx)(eE.Rx,{onClick:p,disabled:n,className:"bg-red-600 hover:bg-red-700",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete Receipt"}):(0,a.jsx)(d.$,{variant:"destructive",disabled:!0,className:"cursor-not-allowed",children:"No Delete Permission"})]})]})})}var eR=t(7803);function eq(){let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(null),[n,c]=(0,r.useState)(!0),[d,o]=(0,r.useState)(!1),[m,u]=(0,r.useState)(""),[p,x]=(0,r.useState)(1),[g,v]=(0,r.useState)(10),[j,y]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!1),[N,_]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),[k,A]=(0,r.useState)(null),[S,P]=(0,r.useState)(null),{toast:D}=(0,i.dj)(),{hasPermission:F,isAdmin:E}=(0,eA.S)(),I=(0,r.useRef)(0);(0,r.useRef)(null);let R=(0,r.useCallback)(async(e=!1)=>{let t=Date.now(),a=t-I.current;if(e||!(a<2e3))try{c(!0);let e=await h();s(Array.isArray(e)?e:[]),I.current=t}catch(e){console.error("Error fetching product receipts:",e),s([]),D({title:"Error",description:e.message||"Failed to load product receipts. Please try again.",variant:"destructive"})}finally{c(!1)}},[D]);(0,r.useCallback)(async()=>{let e=Date.now();if(!(e-I.current<2e3))try{o(!0);let t=await h();s(Array.isArray(t)?t:[]),I.current=e}catch(e){console.error("Error revalidating product receipts:",e)}finally{o(!1)}},[]);let q=(0,r.useCallback)(async()=>{await R(!0),(0,ei.Z4)("product_receipt_summary"),D({title:"Refreshed",description:"Product receipts data has been updated."})},[R,D]),$=e.filter(e=>{let s=m.toLowerCase();return e.supplier?.name?.toLowerCase().includes(s)||e.reference_number?.toLowerCase().includes(s)||e.document_type?.toLowerCase().includes(s)}),L=Math.ceil($.length/g),V=(p-1)*g,T=$.slice(V,V+g),J=e=>{A(e),_(!0)};return(0,a.jsx)(eR.PermissionGuard,{permissions:["can_view_product_receipt_menu","can_manage_system","can_manage_company"],fallback:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[(0,a.jsx)(eN.A,{className:"h-12 w-12 text-red-500"}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Access Denied"}),(0,a.jsxs)("p",{className:"text-gray-500 text-center",children:["You do not have permission to view product receipts.",(0,a.jsx)("br",{}),"Please contact your administrator to request access."]})]}),children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Product Receipts"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage and track your product receipts"})]}),(0,a.jsx)(el,{}),(0,a.jsx)(es,{receipts:T,loading:n,onViewReceipt:e=>{l(e),y(!0)},onEditReceipt:J,onDeleteReceipt:e=>{P(e),C(!0)},search:m,onSearchChange:u,currentPage:p,totalPages:L,rowsPerPage:g,onPageChange:x,onRowsPerPageChange:v,totalItems:$.length,onRefresh:q,onCreateNew:()=>b(!0)}),(0,a.jsx)(O,{open:j,onOpenChange:e=>{y(e),e||l(null)},receiptId:t?.id||null,onEdit:s=>{let t=e.find(e=>e.id===s);t&&J(t)}}),(0,a.jsx)(eR.PermissionGuard,{permissions:["can_create_product_receipts","can_manage_system","can_manage_company"],hideOnDenied:!0,children:(0,a.jsx)(eP,{open:f,onOpenChange:b,onSuccess:()=>{b(!1),R(!0),(0,ei.Z4)("product_receipt_summary"),D({title:"Success",description:"Product receipt created successfully."})}})}),(0,a.jsx)(eR.PermissionGuard,{permissions:["can_update_product_receipts","can_manage_system","can_manage_company"],hideOnDenied:!0,children:(0,a.jsx)(eF,{open:N,onOpenChange:_,onSuccess:()=>{_(!1),A(null),R(!0),(0,ei.Z4)("product_receipt_summary"),D({title:"Success",description:"Product receipt updated successfully."})},productReceipt:k})}),(0,a.jsx)(eR.PermissionGuard,{permissions:["can_delete_product_receipts","can_manage_system","can_manage_company"],hideOnDenied:!0,children:(0,a.jsx)(eI,{open:w,onOpenChange:C,productReceipt:S,onSuccess:()=>{C(!1),P(null),R(!0),(0,ei.Z4)("product_receipt_summary"),D({title:"Success",description:"Product receipt deleted successfully."})}})})]})})}},40228:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},46001:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]])},47033:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},48340:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},55146:(e,s,t)=>{"use strict";t.d(s,{B8:()=>P,UC:()=>F,bL:()=>S,l9:()=>D});var a=t(43210),r=t(70569),i=t(11273),l=t(72942),n=t(46059),c=t(14163),d=t(43),o=t(65551),m=t(96963),u=t(60687),p="Tabs",[x,h]=(0,i.A)(p,[l.RG]),g=(0,l.RG)(),[v,j]=x(p),y=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:a,onValueChange:r,defaultValue:i,orientation:l="horizontal",dir:n,activationMode:x="automatic",...h}=e,g=(0,d.jH)(n),[j,y]=(0,o.i)({prop:a,onChange:r,defaultProp:i??"",caller:p});return(0,u.jsx)(v,{scope:t,baseId:(0,m.B)(),value:j,onValueChange:y,orientation:l,dir:g,activationMode:x,children:(0,u.jsx)(c.sG.div,{dir:g,"data-orientation":l,...h,ref:s})})});y.displayName=p;var f="TabsList",b=a.forwardRef((e,s)=>{let{__scopeTabs:t,loop:a=!0,...r}=e,i=j(f,t),n=g(t);return(0,u.jsx)(l.bL,{asChild:!0,...n,orientation:i.orientation,dir:i.dir,loop:a,children:(0,u.jsx)(c.sG.div,{role:"tablist","aria-orientation":i.orientation,...r,ref:s})})});b.displayName=f;var N="TabsTrigger",_=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:a,disabled:i=!1,...n}=e,d=j(N,t),o=g(t),m=k(d.baseId,a),p=A(d.baseId,a),x=a===d.value;return(0,u.jsx)(l.q7,{asChild:!0,...o,focusable:!i,active:x,children:(0,u.jsx)(c.sG.button,{type:"button",role:"tab","aria-selected":x,"aria-controls":p,"data-state":x?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:m,...n,ref:s,onMouseDown:(0,r.m)(e.onMouseDown,e=>{i||0!==e.button||!1!==e.ctrlKey?e.preventDefault():d.onValueChange(a)}),onKeyDown:(0,r.m)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&d.onValueChange(a)}),onFocus:(0,r.m)(e.onFocus,()=>{let e="manual"!==d.activationMode;x||i||!e||d.onValueChange(a)})})})});_.displayName=N;var w="TabsContent",C=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:r,forceMount:i,children:l,...d}=e,o=j(w,t),m=k(o.baseId,r),p=A(o.baseId,r),x=r===o.value,h=a.useRef(x);return a.useEffect(()=>{let e=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,u.jsx)(n.C,{present:i||x,children:({present:t})=>(0,u.jsx)(c.sG.div,{"data-state":x?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":m,hidden:!t,id:p,tabIndex:0,...d,ref:s,style:{...e.style,animationDuration:h.current?"0s":void 0},children:t&&l})})});function k(e,s){return`${e}-trigger-${s}`}function A(e,s){return`${e}-content-${s}`}C.displayName=w;var S=y,P=b,D=_,F=C},58164:(e,s,t)=>{"use strict";t.d(s,{C5:()=>j,MJ:()=>g,Rr:()=>v,eI:()=>x,lR:()=>h,lV:()=>d,zB:()=>m});var a=t(60687),r=t(43210),i=t(8730),l=t(27605),n=t(96241),c=t(39390);let d=l.Op,o=r.createContext({}),m=({...e})=>(0,a.jsx)(o.Provider,{value:{name:e.name},children:(0,a.jsx)(l.xI,{...e})}),u=()=>{let e=r.useContext(o),s=r.useContext(p),{getFieldState:t,formState:a}=(0,l.xW)(),i=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=s;return{id:n,name:e.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...i}},p=r.createContext({}),x=r.forwardRef(({className:e,...s},t)=>{let i=r.useId();return(0,a.jsx)(p.Provider,{value:{id:i},children:(0,a.jsx)("div",{ref:t,className:(0,n.cn)("space-y-2",e),...s})})});x.displayName="FormItem";let h=r.forwardRef(({className:e,...s},t)=>{let{error:r,formItemId:i}=u();return(0,a.jsx)(c.J,{ref:t,className:(0,n.cn)(r&&"text-destructive",e),htmlFor:i,...s})});h.displayName="FormLabel";let g=r.forwardRef(({...e},s)=>{let{error:t,formItemId:r,formDescriptionId:l,formMessageId:n}=u();return(0,a.jsx)(i.DX,{ref:s,id:r,"aria-describedby":t?`${l} ${n}`:`${l}`,"aria-invalid":!!t,...e})});g.displayName="FormControl";let v=r.forwardRef(({className:e,...s},t)=>{let{formDescriptionId:r}=u();return(0,a.jsx)("p",{ref:t,id:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...s})});v.displayName="FormDescription";let j=r.forwardRef(({className:e,children:s,...t},r)=>{let{error:i,formMessageId:l}=u(),c=i?String(i?.message):s;return c?(0,a.jsx)("p",{ref:r,id:l,className:(0,n.cn)("text-sm font-medium text-destructive",e),...t,children:c}):null});j.displayName="FormMessage"},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78122:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},83683:(e,s,t)=>{Promise.resolve().then(t.bind(t,37588))},85910:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>d,av:()=>o,j7:()=>c,tU:()=>n});var a=t(60687),r=t(43210),i=t(55146),l=t(96241);let n=i.bL,c=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(i.B8,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));c.displayName=i.B8.displayName;let d=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(i.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));d.displayName=i.l9.displayName;let o=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(i.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));o.displayName=i.UC.displayName},88059:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},93661:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},96474:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},96911:(e,s,t)=>{"use strict";t.d(s,{e9:()=>r});let a={api:{baseUrl:"http://localhost:8000/api",appUrl:"http://localhost:3000"},email:{resendApiKey:process.env.RESEND_API_KEY},whatsapp:{apiUrl:process.env.WHATSAPP_API_URL||"https://graph.facebook.com/v21.0",apiToken:process.env.WHATSAPP_API_TOKEN,phoneNumberId:process.env.WHATSAPP_PHONE_NUMBER_ID,accessToken:process.env.WHATSAPP_ACCESS_TOKEN,businessAccountId:process.env.WHATSAPP_BUSINESS_ACCOUNT_ID,catalogId:process.env.WHATSAPP_CATALOG_ID},isDevelopment:!1,isProduction:!0,isTest:!1},r=(e="")=>{let s=a.api.baseUrl;return console.log(`API Base URL: ${s}, Path: ${e}`),`${s}${e}`}}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[7719,6447,3399,5814,7676,1126,4097,5902,5650,7895,5149,5647,273,447,7467,1158,6173,1231,5767,3956,4377],()=>t(36559));module.exports=a})();